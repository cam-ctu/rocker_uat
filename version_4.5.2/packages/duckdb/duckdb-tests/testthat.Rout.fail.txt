
R version 4.5.2 (2025-10-31) -- "[Not] Part in a Rumble"
Copyright (C) 2025 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library("testthat")
> library("DBI")
> 
> test_check("duckdb")
Loading required package: duckdb
Saving _problems/test-relational-126.R
Saving _problems/test-relational-151.R
Saving _problems/test-relational-170.R
[ FAIL 3 | WARN 0 | SKIP 75 | PASS 816 ]

══ Skipped tests (75) ══════════════════════════════════════════════════════════
• empty test (1): 'test-factor.R:78:1'
• interactive() is not TRUE (2): 'test-connect.R:5:3', 'test-connect.R:15:3'
• On CRAN (37): 'test-array.R:174:1', 'test-array.R:187:1',
  'test-array.R:202:1', 'test-array.R:359:1', 'test-arrow_stream.R:1:1',
  'test-arrow.R:18:1', 'test-backend-dbplyr__duckdb_connection.R:405:3',
  'test-backend-dbplyr__duckdb_connection.R:436:3',
  'test-backend-dbplyr__duckdb_connection.R:478:3',
  'test-backend-dbplyr__duckdb_connection.R:502:3',
  'test-backend-dbplyr__duckdb_connection.R:547:3',
  'test-backend-dbplyr__duckdb_connection.R:576:3',
  'test-backend-dbplyr__duckdb_connection.R:600:3',
  'test-backend-dbplyr__duckdb_connection.R:615:3', 'test-DBItest.R:1:1',
  'test-duckdb-extensions.R:3:3', 'test-error-handling.R:1:1',
  'test-explain.R:1:1', 'test-extension_path.R:1:1', 'test-fetch_arrow.R:1:1',
  'test-map.R:42:3', 'test-multi_statement.R:1:1', 'test-register_arrow.R:1:1',
  'test-relational.R:80:1', 'test-relational.R:104:1',
  'test-relational.R:220:1', 'test-relational.R:893:1',
  'test-relational.R:911:1', 'test-relational.R:1031:1',
  'test-relational.R:1039:1', 'test-signal.R:6:3', 'test-sql.R:38:1',
  'test-sql.R:133:1', 'test-sql.R:211:1', 'test-struct.R:51:3',
  'test-tbl__duckdb_connection.R:1:1', 'test-types.R:1:1'
• TEST_RE2 is not TRUE (35): 'test-connect.R:59:3', 'test-connect.R:79:3',
  'test-connect.R:99:3', 'test-connect.R:119:3', 'test-connect.R:144:3',
  'test-connect.R:167:3', 'test-connect.R:188:3', 'test-dbwritetable.R:2:3',
  'test-factor.R:2:3', 'test-factor.R:24:3', 'test-factor.R:38:3',
  'test-factor.R:66:3', 'test-read.R:2:3', 'test-read.R:147:3',
  'test-readonly.R:2:3', 'test-register.R:40:3', 'test-rel_api.R:7572:3',
  'test-rel_api.R:7659:3', 'test-rel_api.R:7749:3', 'test-rel_api.R:7839:3',
  'test-rel_api.R:7929:3', 'test-rel_api.R:11050:3', 'test-rel_api.R:11142:3',
  'test-rel_api.R:11237:3', 'test-rel_api.R:11332:3', 'test-rel_api.R:11427:3',
  'test-shutdown.R:2:3', 'test-struct.R:111:3', 'test-struct.R:130:3',
  'test-timestamp.R:2:3', 'test-viewer.R:2:3', 'test-viewer.R:16:3',
  'test-viewer.R:36:3', 'test-viewer.R:57:3', 'test-viewer.R:75:3'

══ Failed tests ════════════════════════════════════════════════════════════════
── Error ('test-relational.R:124:3'): we can create operator expressions ───────
Error in `expr_operator("IN", list(expr_reference("some_column"), expr_constant(-42), expr_constant(42)))`: could not find function "expr_operator"
── Error ('test-relational.R:148:3'): we can use operator expressions in relations ──
Error in `eval(code, test_env)`: could not find function "expr_operator"
Backtrace:
     ▆
  1. ├─duckdb:::rel_filter(...) at test-relational.R:148:3
  2. │ └─duckdb:::rethrow_rapi_rel_filter(rel, exprs)
  3. │   ├─rlang::try_fetch(...)
  4. │   │ ├─base::tryCatch(...)
  5. │   │ │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
  6. │   │ │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
  7. │   │ │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
  8. │   │ └─base::withCallingHandlers(...)
  9. │   └─duckdb:::rapi_rel_filter(rel, exprs)
 10. └─base::.handleSimpleError(...)
 11.   └─rlang (local) h(simpleError(msg, call))
 12.     └─handlers[[1L]](cnd)
 13.       └─duckdb:::rethrow_error_from_rapi(e, call)
 14.         └─rlang::abort(msg, call = call)
── Failure ('test-relational.R:167:3'): expr_operator validates ... parameter ──
`expr_operator("IN", list(expr_reference("col")), extra_param = "value")` threw an error with unexpected message.
Expected match: "... must be empty"
Actual message: "could not find function \"expr_operator\""
Backtrace:
    ▆
 1. └─testthat::expect_error(...) at test-relational.R:167:3
 2.   └─testthat:::quasi_capture(...)
 3.     ├─testthat (local) .capture(...)
 4.     │ └─base::withCallingHandlers(...)
 5.     └─rlang::eval_bare(quo_get_expr(.quo), quo_get_env(.quo))

[ FAIL 3 | WARN 0 | SKIP 75 | PASS 816 ]
Error:
! Test failures.
Execution halted
