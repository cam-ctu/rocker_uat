
R version 4.5.2 (2025-10-31) -- "[Not] Part in a Rumble"
Copyright (C) 2025 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> #! /usr/bin/env Rscript
> ## This runs testme test script inst/testme/test-as.cluster.R
> ## Don't edit - it was autogenerated by inst/testme/deploy.R
> parallelly:::testme("as.cluster")
Test ‘as.cluster’ ...

> library(parallelly)

> stopCluster <- parallel::stopCluster

> useXDR <- isTRUE(parallelly:::getOption2("parallelly.makeNodePSOCK.useXDR"))

> message("*** cluster operations ...")
*** cluster operations ...

> local({
+     cl0 <- makeClusterPSOCK(1)
+     on.exit(stopCluster(cl0))
+     cl <- cl0
+     print(cl)
+     message("*** cluster operations - as. ..." ... [TRUNCATED] 
Socket cluster with 1 node on host ‘localhost’ (R version 4.5.2 (2025-10-31), platform x86_64-pc-linux-gnu)
*** cluster operations - as.cluster() ...
Socket cluster with 1 node on host ‘localhost’ (R version 4.5.2 (2025-10-31), platform x86_64-pc-linux-gnu)
RichSOCKnode of a socket cluster on local host 'localhost' with pid 102996 (R version 4.5.2 (2025-10-31), x86_64-pc-linux-gnu) using socket connection #4 ('<-localhost:11925')
RichSOCKnode of a socket cluster on local host 'localhost' with pid 102996 (R version 4.5.2 (2025-10-31), x86_64-pc-linux-gnu) using socket connection #4 ('<-localhost:11925')
Socket cluster with 1 node on host ‘localhost’ (R version 4.5.2 (2025-10-31), platform x86_64-pc-linux-gnu)
Warning in c.cluster(init, x[[i]]) :
  The combined cluster contains 1 duplicated nodes
Socket cluster with 2 nodes on host ‘localhost’ (R version 4.5.2 (2025-10-31), platform x86_64-pc-linux-gnu)
*** cluster operations - as.cluster() ... DONE
*** cluster operations - c(...) ...
Socket cluster with 1 node on host ‘localhost’ (R version 4.5.2 (2025-10-31), platform x86_64-pc-linux-gnu)
Socket cluster with 2 nodes on host ‘localhost’ (R version 4.5.2 (2025-10-31), platform x86_64-pc-linux-gnu)
*** cluster operations - c(...) ... DONE

> message("*** cluster operations - makeClusterPSOCK(remotes) ...")
*** cluster operations - makeClusterPSOCK(remotes) ...

> remotes <- Sys.getenv("R_PARALLELLY_TESTS_REMOTES", 
+     "")

> remotes <- gsub(" ", "", unlist(strsplit(remotes, 
+     split = ",")))

> remotes <- remotes[nzchar(remotes)]

> if (length(remotes) > 0) {
+     message("Remotes: ", paste(sQuote(remotes), collapse = ", "))
+     local({
+         cl <- makeClusterPSOCK(remote .... [TRUNCATED] 

> message("*** cluster operations - makeClusterPSOCK(remotes) ... DONE")
*** cluster operations - makeClusterPSOCK(remotes) ... DONE

> message("*** cluster operations ... DONE")
*** cluster operations ... DONE

> message("*** cluster operations - as.cluster(<non-cluster>) ...")
*** cluster operations - as.cluster(<non-cluster>) ...

> res <- tryCatch({
+     as.cluster(1)
+ }, error = function(ex) ex)

> stopifnot(inherits(res, "error"))

> message("*** cluster operations - as.cluster(<non-cluster>) ... DONE")
*** cluster operations - as.cluster(<non-cluster>) ... DONE

> message("*** cluster operations - c(...) with duplicated nodes ...")
*** cluster operations - c(...) with duplicated nodes ...

> cl_dup1 <- makeClusterPSOCK(1)

> on.exit(stopCluster(cl_dup1), add = TRUE)

> cl_combined <- c(cl_dup1, cl_dup1)
Warning in c.cluster(cl_dup1, cl_dup1) :
  The combined cluster contains 1 duplicated nodes

> stopifnot(inherits(cl_combined, "cluster"), length(cl_combined) == 
+     2)

> message("*** cluster operations - c(...) with duplicated nodes ... DONE")
*** cluster operations - c(...) with duplicated nodes ... DONE

> message("*** cluster operations - as.cluster(SOCKnode) ...")
*** cluster operations - as.cluster(SOCKnode) ...

> cl_base <- parallel::makeCluster(1, type = "PSOCK")

> node_base <- cl_base[[1]]

> res_base <- as.cluster(node_base)

> stopifnot(inherits(res_base, "cluster"), inherits(res_base[[1]], 
+     "SOCKnode"))

> parallel::stopCluster(cl_base)

> message("*** cluster operations - as.cluster(SOCKnode) ... DONE")
*** cluster operations - as.cluster(SOCKnode) ... DONE
Test time: user.self=0.1s, sys.self=0.005s, elapsed=1s, user.child=0.2s, sys.child=0.3s
Test ‘as.cluster’ ... success
> 
