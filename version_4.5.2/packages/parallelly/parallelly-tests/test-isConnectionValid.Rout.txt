
R version 4.5.2 (2025-10-31) -- "[Not] Part in a Rumble"
Copyright (C) 2025 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> #! /usr/bin/env Rscript
> ## This runs testme test script inst/testme/test-isConnectionValid.R
> ## Don't edit - it was autogenerated by inst/testme/deploy.R
> parallelly:::testme("isConnectionValid")
Test ‘isConnectionValid’ ...

> library(parallelly)

> message("isConnectionValid() ...")
isConnectionValid() ...

> stopifnot(connectionId(stdin()) == 0)

> stopifnot(connectionId(stdout()) == 1)

> stopifnot(connectionId(stderr()) == 2)

> con_no_id <- file(tempfile(), open = "w+")

> class(con_no_id) <- c("test_connection", class(con_no_id))

> attr(con_no_id, "conn_id") <- NULL

> res <- connectionId(con_no_id)

> stopifnot(is.na(res))

> close(con_no_id)

> con_ser <- file(tempfile(), open = "w")

> x_ser <- list(con = con_ser)

> y_ser <- unserialize(serialize(x_ser, connection = NULL))

> stopifnot(connectionId(y_ser$con) == -1)

> close(con_ser)

> con_valid <- file(tempfile(), open = "w+")

> id_valid <- connectionId(con_valid)

> stopifnot(is.integer(id_valid), id_valid >= 3)

> close(con_valid)

> stopifnot(isConnectionValid(stdin()))

> stopifnot(isConnectionValid(stdout()))

> stopifnot(isConnectionValid(stderr()))

> con_ser_valid <- file(tempfile(), open = "w")

> x_ser_valid <- list(con = con_ser_valid)

> y_ser_valid <- unserialize(serialize(x_ser_valid, 
+     connection = NULL))

> res_ser_valid <- isConnectionValid(y_ser_valid$con)

> stopifnot(!res_ser_valid, inherits(attr(res_ser_valid, 
+     "reason"), "character"))

> close(con_ser_valid)

> con_real_valid <- file(tempfile(), open = "w+")

> stopifnot(isConnectionValid(con_real_valid))

> close(con_real_valid)

> con_temp_file <- file(tempfile(), open = "w+")

> close(con_temp_file)

> res_non_existent <- isConnectionValid(con_temp_file)

> stopifnot(!res_non_existent, inherits(attr(res_non_existent, 
+     "reason"), "character"))

> message("isConnectionValid() ... done")
isConnectionValid() ... done
Test time: user.self=0.05s, sys.self=0.002s, elapsed=0.05s, user.child=0s, sys.child=0s
Test ‘isConnectionValid’ ... success
> 
