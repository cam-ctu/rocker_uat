
R version 4.3.0 (2023-04-21) -- "Already Tomorrow"
Copyright (C) 2023 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> require(optimx)
Loading required package: optimx
> # test function from book by Owen Jones et al
> 
> # function is 2 variables to be maximized
> #  f(x,y)=sin(x^2/2 - y^2/4)*cos(2x-exp(y))
> 
> # ?? seems to have unstable parameter 1
> 
> jones<-function(xx){
+    x<-xx[1]
+    y<-xx[2]
+    ff<-sin(x*x/2 - y*y/4)*cos(2*x-exp(y))
+    ff<- -ff
+ }
> 
> jonesg <- function(xx) {
+    x<-xx[1]
+    y<-xx[2]
+    gx <-  cos(x * x/2 - y * y/4) * ((x + x)/2) * cos(2 * x - exp(y)) - 
+          sin(x * x/2 - y * y/4) * (sin(2 * x - exp(y)) * 2)
+    gy <- sin(x * x/2 - y * y/4) * (sin(2 * x - exp(y)) * exp(y)) - cos(x * 
+           x/2 - y * y/4) * ((y + y)/4) * cos(2 * x - exp(y))
+    gg <- - c(gx, gy)
+ }
> 
> # Note: No hessian, so newton methods will fail
> 
> xx<-0.5*c(pi,pi)
> ans<-opm(xx, jones, jonesg, method="ALL", control=list(trace=0))
Warning messages:
1: In optimr(par, fn, gr, hess = hess, method = meth, lower = lower,  :
  Note: snewton needs Hessian function (hess) specified
2: In optimr(par, fn, gr, hess = hess, method = meth, lower = lower,  :
  Note: snewtonm needs Hessian function specified
3: In optimr(par, fn, gr, hess = hess, method = meth, lower = lower,  :
  Successful convergence  Restarts for stagnation =0
> print(summary(ans, order=value))
                  p1        p2          value fevals gevals convergence  kkt1
Rcgmin      1.588067 -3.365576  -1.000000e+00     18     10           0  TRUE
Rtnmin      2.030697  1.401526  -1.000000e+00     18     18           0  TRUE
Rvmmin      3.154083 -3.689620  -1.000000e+00     28     17           0  TRUE
subplex     2.030697  1.401526  -1.000000e+00    324     NA           0  TRUE
nlm         3.154083 -3.689620  -1.000000e+00     NA     14           0  TRUE
newuoa      2.030697  1.401526  -1.000000e+00     47     NA           0  TRUE
spg         2.030697  1.401526  -1.000000e+00     21     19           0  TRUE
bobyqa      2.030697  1.401526  -1.000000e+00     53     NA           0  TRUE
ucminf      2.030697  1.401526  -1.000000e+00     11     11           0  TRUE
hjn         2.030697  1.401526  -1.000000e+00    193     NA           0  TRUE
nlminb      2.030697  1.401526  -1.000000e+00     13     11           0  TRUE
BFGS        3.154083 -3.689621  -1.000000e+00     30     15           0  TRUE
lbfgsb3c    2.030697  1.401526  -1.000000e+00     17     17           0  TRUE
L-BFGS-B    2.030697  1.401526  -1.000000e+00     13     13           0  TRUE
lbfgs       2.030697  1.401526  -1.000000e+00     NA     NA           0  TRUE
CG          3.154084 -3.689622  -1.000000e+00    128     49           0  TRUE
Nelder-Mead 2.030712  1.401531  -1.000000e+00     69     NA           0  TRUE
hjkb        2.467964  5.570430  -9.999998e-01    308     NA           0 FALSE
nmkb        2.031004  1.401581  -9.999998e-01     56     NA           0 FALSE
snewton           NA        NA  8.988466e+307     NA     NA        9997    NA
snewtonm          NA        NA  8.988466e+307     NA     NA        9997    NA
            kkt2 xtime
Rcgmin      TRUE 0.001
Rtnmin      TRUE 0.003
Rvmmin      TRUE 0.002
subplex     TRUE 0.003
nlm         TRUE 0.001
newuoa      TRUE 0.003
spg         TRUE 0.005
bobyqa      TRUE 0.001
ucminf      TRUE 0.000
hjn         TRUE 0.001
nlminb      TRUE 0.001
BFGS        TRUE 0.032
lbfgsb3c    TRUE 0.061
L-BFGS-B    TRUE 0.000
lbfgs       TRUE 0.004
CG          TRUE 0.001
Nelder-Mead TRUE 0.000
hjkb        TRUE 0.002
nmkb        TRUE 0.000
snewton       NA 0.001
snewtonm      NA 0.001
> # tmp <- readline("continue")
> 
> lo<-c(0,0)
> up<-c(1.2*pi, 1.2*pi)
> ansb<-opm(xx, jones, jonesg, lower=lo, upper=up, method="ALL", control=list(trace=0))
trace= 0 
Warning message:
In optimr(par, fn, gr, hess = hess, method = meth, lower = lower,  :
  Successful convergence  Restarts for stagnation =0
> print(summary(ansb, order=value))
             p1     p2    value fevals gevals convergence  kkt1 kkt2 xtime
Rcgmin   2.0307 1.4015 -1.00000     31     15           0  TRUE TRUE 0.001
Rtnmin   2.0307 1.4015 -1.00000     18     18           0  TRUE TRUE 0.003
Rvmmin   3.1792 1.1684 -1.00000     21     10           0  TRUE TRUE 0.002
nlminb   2.0307 1.4015 -1.00000     13     11           0  TRUE TRUE 0.001
hjn      2.0307 1.4015 -1.00000    193     NA           0  TRUE TRUE 0.001
hjkb     2.0307 1.4015 -1.00000    247     NA           0  TRUE TRUE 0.002
L-BFGS-B 3.1792 1.1684 -1.00000     13     13           0  TRUE TRUE 0.001
nmkb     3.1791 1.1685 -1.00000     57     NA           0  TRUE TRUE 0.004
lbfgsb3c 1.9053 1.2933 -0.97144      8      8           0 FALSE TRUE 0.000
bobyqa   0.2313 2.2946 -0.96018    141     NA           0  TRUE TRUE 0.001
> # tmp <- readline("continue")
> 
> cat("Note: ansbnf shows failure for L-BFGS-B when trying to use forward diff approximation\n")
Note: ansbnf shows failure for L-BFGS-B when trying to use forward diff approximation
> 
> ansbnf<-opm(xx, jones, gr="grfwd", lower=lo, upper=up, method="ALL", control=list(trace=0))
trace= 0 
Warning message:
In optimr(par, fn, gr, hess = hess, method = meth, lower = lower,  :
  Successful convergence  Restarts for stagnation =0
> print(summary(ansbnf, order=value))
              p1     p2    value fevals gevals convergence  kkt1  kkt2 xtime
Rcgmin   2.03070 1.4015 -1.00000     43     24           0  TRUE  TRUE 0.001
Rvmmin   3.17921 1.1684 -1.00000     22     11           0  TRUE  TRUE 0.001
nlminb   2.03070 1.4015 -1.00000     13     11           0  TRUE  TRUE 0.001
hjn      2.03070 1.4015 -1.00000    193     NA           0  TRUE  TRUE 0.001
Rtnmin   2.03070 1.4015 -1.00000     19     19           0  TRUE  TRUE 0.002
hjkb     0.99302 2.8732 -1.00000    374     NA           0  TRUE  TRUE 0.003
nmkb     3.17912 1.1685 -1.00000     57     NA           0  TRUE  TRUE 0.003
lbfgsb3c 1.90534 1.2933 -0.97144      8      8           0 FALSE  TRUE 0.001
bobyqa   0.23130 2.2946 -0.96018    141     NA           0  TRUE  TRUE 0.001
L-BFGS-B 2.68165 0.0000 -0.15002      7      7           0  TRUE FALSE 0.001
> # tmp <- readline("continue")
> 
> ansbnn<-opm(xx, jones, gr="grnd", lower=lo, upper=up, method="ALL", control=list(trace=0))
trace= 0 
Warning message:
In optimr(par, fn, gr, hess = hess, method = meth, lower = lower,  :
  Successful convergence  Restarts for stagnation =0
> print(summary(ansbnn, order=value))
             p1     p2    value fevals gevals convergence  kkt1 kkt2 xtime
Rcgmin   2.0307 1.4015 -1.00000     31     15           0  TRUE TRUE 0.003
Rtnmin   2.0307 1.4015 -1.00000     18     18           0  TRUE TRUE 0.005
Rvmmin   3.1792 1.1684 -1.00000     21     10           0  TRUE TRUE 0.003
nlminb   2.0307 1.4015 -1.00000     13     11           0  TRUE TRUE 0.002
hjn      2.0307 1.4015 -1.00000    193     NA           0  TRUE TRUE 0.002
L-BFGS-B 3.1792 1.1684 -1.00000     13     13           0  TRUE TRUE 0.003
hjkb     2.0307 1.4015 -1.00000    259     NA           0  TRUE TRUE 0.002
nmkb     3.1791 1.1685 -1.00000     57     NA           0  TRUE TRUE 0.003
lbfgsb3c 1.9053 1.2933 -0.97144      8      8           0 FALSE TRUE 0.002
bobyqa   0.2313 2.2946 -0.96018    141     NA           0  TRUE TRUE 0.001
> # tmp <- readline("continue")
> 
> 
