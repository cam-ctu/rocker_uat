
R version 4.3.0 (2023-04-21) -- "Already Tomorrow"
Copyright (C) 2023 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> cat("Show how kktc works\n")
Show how kktc works
> require(optimx)
Loading required package: optimx
> 
> jones<-function(xx){
+    x<-xx[1]
+    y<-xx[2]
+    ff<-sin(x*x/2 - y*y/4)*cos(2*x-exp(y))
+    ff<- -ff
+ }
> 
> jonesg <- function(xx) {
+    x<-xx[1]
+    y<-xx[2]
+    gx <-  cos(x * x/2 - y * y/4) * ((x + x)/2) * cos(2 * x - exp(y)) - 
+          sin(x * x/2 - y * y/4) * (sin(2 * x - exp(y)) * 2)
+    gy <- sin(x * x/2 - y * y/4) * (sin(2 * x - exp(y)) * exp(y)) - cos(x * 
+           x/2 - y * y/4) * ((y + y)/4) * cos(2 * x - exp(y))
+    gg <- - c(gx, gy)
+ }
> 
> xx<-0.5*c(pi,pi)
> ans <- list() # set up structure
> 
> 
> # can call following if optimx present and updated
> # ans <- optimr(xx, jones, jonesg, method="Rvmmin")
> # ans
> 
> ans$par <- c(3.154083, -3.689620)
> kkans <- kktchk(ans$par, jones, jonesg)
> kkans
$gmax
[1] 3.10669e-06

$evratio
[1] 0.052218

$kkt1
[1] TRUE

$kkt2
[1] TRUE

$hev
[1] 16.49106  0.86113

$ngatend
[1] -3.106690e-06 -8.608104e-07

$nhatend
          [,1]     [,2]
[1,] 13.948239 5.768721
[2,]  5.768721 3.403948

> 
