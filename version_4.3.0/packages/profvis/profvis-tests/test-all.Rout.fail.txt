
R version 4.3.0 (2023-04-21) -- "Already Tomorrow"
Copyright (C) 2023 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(testthat)
> library(profvis)
> 
> test_check("profvis")
[ FAIL 2 | WARN 1 | SKIP 2 | PASS 16 ]

══ Skipped tests ═══════════════════════════════════════════════════════════════
• On CRAN (2)

══ Failed tests ════════════════════════════════════════════════════════════════
── Error ('test-rprof.R:20:3'): `filter.callframes` filters out intervening frames ──
`!!quo` threw an unexpected error.
Message: Quosures can only be unquoted within a quasiquotation context.

# Bad: list(!!myquosure)

# Good: dplyr::mutate(data, !!myquosure)
Class:   rlang_error/error/condition
Backtrace:
     ▆
  1. └─profvis:::expect_snapshot0(cat_rprof(f(), filter.callframes = TRUE)) at test-rprof.R:20:3
  2.   ├─testthat::expect_snapshot(!!quo, cran = cran) at profvis-tests/testthat/helper-profvis.R:18:3
  3.   │ └─testthat:::verify_exec(quo_get_expr(x), quo_get_env(x), replay)
  4.   │   └─evaluate::evaluate(source, envir = env, new_device = FALSE, output_handler = handler)
  5.   │     ├─base::withRestarts(...)
  6.   │     │ └─base (local) withRestartList(expr, restarts)
  7.   │     │   ├─base (local) withOneRestart(withRestartList(expr, restarts[-nr]), restarts[[nr]])
  8.   │     │   │ └─base (local) doWithOneRestart(return(expr), restart)
  9.   │     │   └─base (local) withRestartList(expr, restarts[-nr])
 10.   │     │     ├─base (local) withOneRestart(withRestartList(expr, restarts[-nr]), restarts[[nr]])
 11.   │     │     │ └─base (local) doWithOneRestart(return(expr), restart)
 12.   │     │     └─base (local) withRestartList(expr, restarts[-nr])
 13.   │     │       └─base (local) withOneRestart(expr, restarts[[1L]])
 14.   │     │         └─base (local) doWithOneRestart(return(expr), restart)
 15.   │     ├─evaluate:::with_handlers(...)
 16.   │     │ ├─base::eval(call)
 17.   │     │ │ └─base::eval(call)
 18.   │     │ └─base::withCallingHandlers(...)
 19.   │     ├─base::withVisible(eval(expr, envir))
 20.   │     └─base::eval(expr, envir)
 21.   │       └─base::eval(expr, envir)
 22.   └─rlang:::Ops.quosure(quo)
 23.     └─rlang::abort(...)
── Error ('test-rprof.R:24:3'): `filter.callframes` filters out intervening frames ──
`!!quo` threw an unexpected error.
Message: Quosures can only be unquoted within a quasiquotation context.

# Bad: list(!!myquosure)

# Good: dplyr::mutate(data, !!myquosure)
Class:   rlang_error/error/condition
Backtrace:
     ▆
  1. └─profvis:::expect_snapshot0(cat_rprof(f(), filter.callframes = TRUE)) at test-rprof.R:24:3
  2.   ├─testthat::expect_snapshot(!!quo, cran = cran) at profvis-tests/testthat/helper-profvis.R:18:3
  3.   │ └─testthat:::verify_exec(quo_get_expr(x), quo_get_env(x), replay)
  4.   │   └─evaluate::evaluate(source, envir = env, new_device = FALSE, output_handler = handler)
  5.   │     ├─base::withRestarts(...)
  6.   │     │ └─base (local) withRestartList(expr, restarts)
  7.   │     │   ├─base (local) withOneRestart(withRestartList(expr, restarts[-nr]), restarts[[nr]])
  8.   │     │   │ └─base (local) doWithOneRestart(return(expr), restart)
  9.   │     │   └─base (local) withRestartList(expr, restarts[-nr])
 10.   │     │     ├─base (local) withOneRestart(withRestartList(expr, restarts[-nr]), restarts[[nr]])
 11.   │     │     │ └─base (local) doWithOneRestart(return(expr), restart)
 12.   │     │     └─base (local) withRestartList(expr, restarts[-nr])
 13.   │     │       └─base (local) withOneRestart(expr, restarts[[1L]])
 14.   │     │         └─base (local) doWithOneRestart(return(expr), restart)
 15.   │     ├─evaluate:::with_handlers(...)
 16.   │     │ ├─base::eval(call)
 17.   │     │ │ └─base::eval(call)
 18.   │     │ └─base::withCallingHandlers(...)
 19.   │     ├─base::withVisible(eval(expr, envir))
 20.   │     └─base::eval(expr, envir)
 21.   │       └─base::eval(expr, envir)
 22.   └─rlang:::Ops.quosure(quo)
 23.     └─rlang::abort(...)

[ FAIL 2 | WARN 1 | SKIP 2 | PASS 16 ]
Error: Test failures
No deferred expressions to run
Execution halted
