
R version 4.4.3 (2025-02-28) -- "Trophy Case"
Copyright (C) 2025 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> source("incl/start.R")
Loading required package: future
[08:26:30.022] plan(): Setting new future strategy stack:
[08:26:30.022] List of future strategies:
[08:26:30.022] 1. sequential:
[08:26:30.022]    - args: function (..., envir = parent.frame(), workers = "<NULL>")
[08:26:30.022]    - tweaked: FALSE
[08:26:30.022]    - call: future::plan("sequential")
[08:26:30.037] plan(): nbrOfWorkers() = 1
> 
> message("*** Options in nested parallelization ...")
*** Options in nested parallelization ...
> 
> options(future.debug = FALSE)
> options(future.apply.debug = FALSE)
> options(future.globals.maxSize = 1234000)
> 
> for (cores in 1:availCores) {
+   message(sprintf("Testing with %d cores ...", cores))
+   options(mc.cores = cores)
+   strategies <- supportedStrategies(cores)
+ 
+   for (strategy1 in strategies) {
+     for (strategy2 in strategies) {
+       message(sprintf("- plan('%s') ...", strategy2))
+       plan(list(outer = tweak(strategy1), inner = strategy2))
+ 
+       v <- future_lapply(1:2, FUN = function(x) {
+         outer <- data.frame(
+           label   = "outer",
+           idx     = x,
+           pid     = Sys.getpid(),
+           maxSize = getOption("future.globals.maxSize", NA_real_)
+         )
+         
+         inner <- future_lapply(3:4, FUN = function(x) {
+           data.frame(
+             label   = "inner",
+             idx     = x,
+             pid     = Sys.getpid(),
+             maxSize = getOption("future.globals.maxSize", NA_real_))
+         })
+         inner <- do.call(rbind, inner)
+         rbind(outer, inner)
+       })
+       v <- do.call(rbind, v)
+       print(v)
+       stopifnot(!anyNA(v$maxSize))
+     } ## for (strategy2 ...)
+   } ## for (strategy1 ...)
+ } ## for (cores in ...)
Testing with 1 cores ...
- plan('sequential') ...
  label idx   pid maxSize
1 outer   1 75281 1234000
2 inner   3 75281 1234000
3 inner   4 75281 1234000
4 outer   2 75281 1234000
5 inner   3 75281 1234000
6 inner   4 75281 1234000
- plan('multicore') ...
  label idx   pid maxSize
1 outer   1 75281 1234000
2 inner   3 75281 1234000
3 inner   4 75281 1234000
4 outer   2 75281 1234000
5 inner   3 75281 1234000
6 inner   4 75281 1234000
- plan('multisession') ...
  label idx   pid maxSize
1 outer   1 75281 1234000
2 inner   3 75281 1234000
3 inner   4 75281 1234000
4 outer   2 75281 1234000
5 inner   3 75281 1234000
6 inner   4 75281 1234000
- plan('sequential') ...
  label idx   pid maxSize
1 outer   1 75281 1234000
2 inner   3 75281 1234000
3 inner   4 75281 1234000
4 outer   2 75281 1234000
5 inner   3 75281 1234000
6 inner   4 75281 1234000
- plan('multicore') ...
  label idx   pid maxSize
1 outer   1 75281 1234000
2 inner   3 75281 1234000
3 inner   4 75281 1234000
4 outer   2 75281 1234000
5 inner   3 75281 1234000
6 inner   4 75281 1234000
- plan('multisession') ...
  label idx   pid maxSize
1 outer   1 75281 1234000
2 inner   3 75281 1234000
3 inner   4 75281 1234000
4 outer   2 75281 1234000
5 inner   3 75281 1234000
6 inner   4 75281 1234000
- plan('sequential') ...
  label idx   pid maxSize
1 outer   1 75281 1234000
2 inner   3 75281 1234000
3 inner   4 75281 1234000
4 outer   2 75281 1234000
5 inner   3 75281 1234000
6 inner   4 75281 1234000
- plan('multicore') ...
  label idx   pid maxSize
1 outer   1 75281 1234000
2 inner   3 75281 1234000
3 inner   4 75281 1234000
4 outer   2 75281 1234000
5 inner   3 75281 1234000
6 inner   4 75281 1234000
- plan('multisession') ...
  label idx   pid maxSize
1 outer   1 75281 1234000
2 inner   3 75281 1234000
3 inner   4 75281 1234000
4 outer   2 75281 1234000
5 inner   3 75281 1234000
6 inner   4 75281 1234000
Testing with 2 cores ...
- plan('multicore') ...
  label idx   pid maxSize
1 outer   1 75303 1234000
2 inner   3 75303 1234000
3 inner   4 75303 1234000
4 outer   2 75304 1234000
5 inner   3 75304 1234000
6 inner   4 75304 1234000
- plan('multisession') ...
  label idx   pid maxSize
1 outer   1 75305 1234000
2 inner   3 75305 1234000
3 inner   4 75305 1234000
4 outer   2 75306 1234000
5 inner   3 75306 1234000
6 inner   4 75306 1234000
- plan('multicore') ...
  label idx   pid maxSize
1 outer   1 75338 1234000
2 inner   3 75338 1234000
3 inner   4 75338 1234000
4 outer   2 75339 1234000
5 inner   3 75339 1234000
6 inner   4 75339 1234000
- plan('multisession') ...
  label idx   pid maxSize
1 outer   1 75439 1234000
2 inner   3 75439 1234000
3 inner   4 75439 1234000
4 outer   2 75440 1234000
5 inner   3 75440 1234000
6 inner   4 75440 1234000
> 
> message("*** Options in nested parallelization ... done")
*** Options in nested parallelization ... done
> 
> source("incl/end.R")
> 
