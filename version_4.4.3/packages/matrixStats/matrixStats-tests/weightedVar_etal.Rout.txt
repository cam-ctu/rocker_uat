
R version 4.4.3 (2025-02-28) -- "Trophy Case"
Copyright (C) 2025 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library("matrixStats")
> 
> fcns <- list(
+   weightedVar = weightedVar,
+   weightedSd  = weightedSd,
+   weightedMad = weightedMad
+ )
> 
> for (name in names(fcns)) {
+   cat(sprintf("%s()...\n", name))
+   fcn <- fcns[[name]]
+ 
+   for (mode in c("integer", "double")) {
+     cat("mode: ", mode, "\n", sep = "")
+     n <- 15L
+     x <- runif(n, min = -5, max = 5)
+     storage.mode(x) <- mode
+     str(x)
+ 
+     for (add_na in c(FALSE, TRUE)) {
+       cat("add_na: ", add_na, "\n", sep = "")
+       if (add_na) {
+         x[c(5, 7)] <- NA
+       }
+       str(x)
+ 
+       for (na.rm in c(FALSE, TRUE)) {
+         cat("na.rm: ", na.rm, "\n", sep = "")
+ 
+         cat("Weights are not specified (all are 1)\n")
+         m1 <- fcn(x, na.rm = na.rm)
+         str(list(m1 = m1))
+ 
+         cat("All weights are 1\n")
+         w <- rep(1, times = n)
+         m1 <- fcn(x, w, na.rm = na.rm)
+         str(list(m1 = m1))
+ 
+         cat("First weight is 5\n")
+         # Pull the mean towards zero
+         w[1] <- 5
+         str(w)
+         m1 <- fcn(x, w, na.rm = na.rm)
+         str(list(m1 = m1))
+ 
+         cat("All weights are 0\n")
+         # All weights set to zero
+         w <- rep(0, times = n)
+         m1 <- fcn(x, w, na.rm = na.rm)
+         str(list(m1 = m1))
+ 
+         cat("First weight is 8.5\n")
+         # Put even more weight on the zero
+         w[1] <- 8.5
+         m1 <- fcn(x, w, na.rm = na.rm)
+         str(list(m1 = m1))
+ 
+         cat("First weight is Inf\n")
+         # All weight on the first value
+         w[1] <- Inf
+         m1 <- fcn(x, w, na.rm = na.rm)
+         str(list(m1 = m1))
+ 
+         cat("Last weight is Inf\n")
+         # All weight on the last value
+         w[1] <- 1
+         w[n] <- Inf
+         m1 <- fcn(x, w, na.rm = na.rm)
+         str(list(m1 = m1))
+ 
+         cat("Last weight is NA\n")
+         # All weight on the last value
+         w[1] <- 1
+         w[n] <- NA_real_
+         m1 <- fcn(x, w, na.rm = na.rm)
+         str(list(m1 = m1))
+       } # for (na.rm ...)
+     } # for (add_na ...)
+   } # for (mode ...)
+ 
+   cat(sprintf("%s()...DONE\n", name))
+ } # for (name ...)
weightedVar()...
mode: integer
 int [1:15] 3 -3 -1 -4 1 1 -2 -2 -2 0 ...
add_na: FALSE
 int [1:15] 3 -3 -1 -4 1 1 -2 -2 -2 0 ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: num 6.07
All weights are 1
List of 1
 $ m1: num 6.07
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 7.43
All weights are 0
List of 1
 $ m1: int NA
First weight is 8.5
List of 1
 $ m1: int NA
First weight is Inf
List of 1
 $ m1: int NA
Last weight is Inf
List of 1
 $ m1: int NA
Last weight is NA
List of 1
 $ m1: int NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 6.07
All weights are 1
List of 1
 $ m1: num 6.07
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 7.43
All weights are 0
List of 1
 $ m1: int NA
First weight is 8.5
List of 1
 $ m1: int NA
First weight is Inf
List of 1
 $ m1: int NA
Last weight is Inf
List of 1
 $ m1: int NA
Last weight is NA
List of 1
 $ m1: int NA
add_na: TRUE
 int [1:15] 3 -3 -1 -4 NA 1 NA -2 -2 0 ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: int NA
All weights are 1
List of 1
 $ m1: int NA
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: int NA
All weights are 0
List of 1
 $ m1: int NA
First weight is 8.5
List of 1
 $ m1: int NA
First weight is Inf
List of 1
 $ m1: int NA
Last weight is Inf
List of 1
 $ m1: int NA
Last weight is NA
List of 1
 $ m1: int NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 6.67
All weights are 1
List of 1
 $ m1: num 6.67
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 8.06
All weights are 0
List of 1
 $ m1: int NA
First weight is 8.5
List of 1
 $ m1: int NA
First weight is Inf
List of 1
 $ m1: int NA
Last weight is Inf
List of 1
 $ m1: int NA
Last weight is NA
List of 1
 $ m1: int NA
mode: double
 num [1:15] -3.75 3.05 -1.3 -2.82 1.56 ...
add_na: FALSE
 num [1:15] -3.75 3.05 -1.3 -2.82 1.56 ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: num 7.99
All weights are 1
List of 1
 $ m1: num 7.99
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 8.46
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 7.99
All weights are 1
List of 1
 $ m1: num 7.99
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 8.46
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
add_na: TRUE
 num [1:15] -3.75 3.05 -1.3 -2.82 NA ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: num NA
All weights are 1
List of 1
 $ m1: num NA
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num NA
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 7.05
All weights are 1
List of 1
 $ m1: num 7.05
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 7.11
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
weightedVar()...DONE
weightedSd()...
mode: integer
 int [1:15] 3 0 -3 -2 0 3 4 -2 0 -4 ...
add_na: FALSE
 int [1:15] 3 0 -3 -2 0 3 4 -2 0 -4 ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: num 2.67
All weights are 1
List of 1
 $ m1: num 2.67
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 2.59
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 2.67
All weights are 1
List of 1
 $ m1: num 2.67
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 2.59
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
add_na: TRUE
 int [1:15] 3 0 -3 -2 NA 3 NA -2 0 -4 ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: num NA
All weights are 1
List of 1
 $ m1: num NA
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num NA
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 2.67
All weights are 1
List of 1
 $ m1: num 2.67
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 2.63
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
mode: double
 num [1:15] 3.28 1.95 1.3 4.49 -3.39 ...
add_na: FALSE
 num [1:15] 3.28 1.95 1.3 4.49 -3.39 ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: num 2.25
All weights are 1
List of 1
 $ m1: num 2.25
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 2.22
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 2.25
All weights are 1
List of 1
 $ m1: num 2.25
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 2.22
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
add_na: TRUE
 num [1:15] 3.28 1.95 1.3 4.49 NA ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: num NA
All weights are 1
List of 1
 $ m1: num NA
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num NA
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 1.81
All weights are 1
List of 1
 $ m1: num 1.81
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 1.76
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
weightedSd()...DONE
weightedMad()...
mode: integer
 int [1:15] -4 -2 -4 -3 -3 -2 4 3 -3 2 ...
add_na: FALSE
 int [1:15] -4 -2 -4 -3 -3 -2 4 3 -3 2 ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: num 2.97
All weights are 1
List of 1
 $ m1: num 2.97
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 1.48
All weights are 0
List of 1
 $ m1: int NA
First weight is 8.5
List of 1
 $ m1: int 0
First weight is Inf
List of 1
 $ m1: int 0
Last weight is Inf
List of 1
 $ m1: int 0
Last weight is NA
List of 1
 $ m1: int NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 2.97
All weights are 1
List of 1
 $ m1: num 2.97
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 1.48
All weights are 0
List of 1
 $ m1: int NA
First weight is 8.5
List of 1
 $ m1: int 0
First weight is Inf
List of 1
 $ m1: int 0
Last weight is Inf
List of 1
 $ m1: int 0
Last weight is NA
List of 1
 $ m1: int NA
add_na: TRUE
 int [1:15] -4 -2 -4 -3 NA -2 NA 3 -3 2 ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: num NA
All weights are 1
List of 1
 $ m1: int NA
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: int NA
All weights are 0
List of 1
 $ m1: int NA
First weight is 8.5
List of 1
 $ m1: int 0
First weight is Inf
List of 1
 $ m1: int 0
Last weight is Inf
List of 1
 $ m1: int 0
Last weight is NA
List of 1
 $ m1: int NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 2.97
All weights are 1
List of 1
 $ m1: num 2.97
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 1.48
All weights are 0
List of 1
 $ m1: int NA
First weight is 8.5
List of 1
 $ m1: int 0
First weight is Inf
List of 1
 $ m1: int 0
Last weight is Inf
List of 1
 $ m1: int 0
Last weight is NA
List of 1
 $ m1: int NA
mode: double
 num [1:15] -1.036 0.597 2.827 -0.992 1.593 ...
add_na: FALSE
 num [1:15] -1.036 0.597 2.827 -0.992 1.593 ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: num 3.83
All weights are 1
List of 1
 $ m1: num 3.83
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 2.54
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num 0
First weight is Inf
List of 1
 $ m1: num 0
Last weight is Inf
List of 1
 $ m1: num 0
Last weight is NA
List of 1
 $ m1: num NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 3.83
All weights are 1
List of 1
 $ m1: num 3.83
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 2.54
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num 0
First weight is Inf
List of 1
 $ m1: num 0
Last weight is Inf
List of 1
 $ m1: num 0
Last weight is NA
List of 1
 $ m1: num NA
add_na: TRUE
 num [1:15] -1.036 0.597 2.827 -0.992 NA ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: num NA
All weights are 1
List of 1
 $ m1: num NA
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num NA
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num 0
First weight is Inf
List of 1
 $ m1: num 0
Last weight is Inf
List of 1
 $ m1: num 0
Last weight is NA
List of 1
 $ m1: num NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 3.59
All weights are 1
List of 1
 $ m1: num 3.59
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 2.42
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num 0
First weight is Inf
List of 1
 $ m1: num 0
Last weight is Inf
List of 1
 $ m1: num 0
Last weight is NA
List of 1
 $ m1: num NA
weightedMad()...DONE
> 
