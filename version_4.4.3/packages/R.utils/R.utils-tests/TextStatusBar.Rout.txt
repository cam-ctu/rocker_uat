
R version 4.4.3 (2025-02-28) -- "Trophy Case"
Copyright (C) 2025 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library("R.utils")
Loading required package: R.oo
Loading required package: R.methodsS3
R.methodsS3 v1.8.2 (2022-06-13 22:00:14 UTC) successfully loaded. See ?R.methodsS3 for help.
R.oo v1.27.0 (2024-11-01 18:00:02 UTC) successfully loaded. See ?R.oo for help.

Attaching package: ‘R.oo’

The following object is masked from ‘package:R.methodsS3’:

    throw

The following objects are masked from ‘package:methods’:

    getClasses, getMethods

The following objects are masked from ‘package:base’:

    attach, detach, load, save

R.utils v2.13.0 (2025-02-24 21:20:02 UTC) successfully loaded. See ?R.utils for help.

Attaching package: ‘R.utils’

The following object is masked from ‘package:utils’:

    timestamp

The following objects are masked from ‘package:base’:

    cat, commandArgs, getOption, isOpen, nullfile, parse, use, warnings

> 
> # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
> # Read all HTML files in the base package
> # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
> path <- system.file(package="base")
> files <- list.files(path, recursive=TRUE, full.names=TRUE)
> files <- files[sapply(files, FUN=isFile)]
> nfiles <- length(files)
> 
> cat(sprintf("Reading %d files in %s:\n", nfiles, path))
Reading 24 files in /usr/local/lib/R/library/base:
> 
> # Create a status bar with four labels
> sb <- TextStatusBar("File: %-*s [%3.0f%% %7.0f bytes %-8s]",
+                 hfill=1, file="", progress=0, nbytes=0L, time="")
> 
> nbytes <- 0L
> for (kk in seq_len(nfiles)) {
+   file <- files[kk]
+ 
+   # Update the status bar
+   if (sb) {
+     setLabel(sb, "progress", 100*kk/nfiles)
+     if (kk %% 10 == 1 || kk == nfiles)
+       setLabel(sb, "file", substr(basename(file), 1, 44))
+ 
+     size <- file.info(file)$size
+     # popMessage() calls update() too
+     popMessage(sb, sprintf("Processing %s (%.2fkB)",
+                                        basename(file), size/1024))
+     flush(sb)
+   }
+ 
+   # Read the file
+   bfr <- readBin(file, what="raw", n=size)
+   nbytes <- nbytes + size
+ 
+   # Emulate a slow process
+   if (interactive()) Sys.sleep(rexp(1, rate=60))
+ 
+   # Update the status bar
+   if (sb) {
+     setLabel(sb, "nbytes", nbytes)
+     setLabel(sb, "time", format(Sys.time(), "%H:%M:%S"))
+     update(sb)
+   }
+ }
Processing CITATION (0.63kB)
File: CITATION                                    [  4%       0 bytes         ]File: CITATION                                    [  4%     643 bytes 10:09:45]                                                                               Processing error.catching.R (3.29kB)
File: CITATION                                    [  8%     643 bytes 10:09:45]File: CITATION                                    [  8%    4010 bytes 10:09:45]                                                                               Processing is.things.R (4.69kB)
File: CITATION                                    [ 12%    4010 bytes 10:09:45]File: CITATION                                    [ 12%    8808 bytes 10:09:45]                                                                               Processing recursion.R (2.07kB)
File: CITATION                                    [ 17%    8808 bytes 10:09:45]File: CITATION                                    [ 17%   10923 bytes 10:09:45]                                                                               Processing scoping.R (1.52kB)
File: CITATION                                    [ 21%   10923 bytes 10:09:45]File: CITATION                                    [ 21%   12483 bytes 10:09:45]                                                                               Processing DESCRIPTION (0.37kB)
File: CITATION                                    [ 25%   12483 bytes 10:09:45]File: CITATION                                    [ 25%   12866 bytes 10:09:45]                                                                               Processing aliases.rds (12.40kB)
File: CITATION                                    [ 29%   12866 bytes 10:09:45]File: CITATION                                    [ 29%   25563 bytes 10:09:45]                                                                               Processing AnIndex (34.86kB)
File: CITATION                                    [ 33%   25563 bytes 10:09:45]File: CITATION                                    [ 33%   61262 bytes 10:09:45]                                                                               Processing base.rdb (2441.66kB)
File: CITATION                                    [ 38%   61262 bytes 10:09:45]File: CITATION                                    [ 38% 2561526 bytes 10:09:45]                                                                               Processing base.rdx (9.11kB)
File: CITATION                                    [ 42% 2561526 bytes 10:09:45]File: CITATION                                    [ 42% 2570857 bytes 10:09:45]                                                                               Processing paths.rds (3.08kB)
File: paths.rds                                   [ 46% 2570857 bytes 10:09:45]File: paths.rds                                   [ 46% 2574013 bytes 10:09:45]                                                                               Processing 00Index.html (148.01kB)
File: paths.rds                                   [ 50% 2574013 bytes 10:09:45]File: paths.rds                                   [ 50% 2725571 bytes 10:09:45]                                                                               Processing R.css (1.80kB)
File: paths.rds                                   [ 54% 2725571 bytes 10:09:45]File: paths.rds                                   [ 54% 2727415 bytes 10:09:45]                                                                               Processing INDEX (24.21kB)
File: paths.rds                                   [ 58% 2727415 bytes 10:09:45]File: paths.rds                                   [ 58% 2752205 bytes 10:09:45]                                                                               Processing demo.rds (0.26kB)
File: paths.rds                                   [ 62% 2752205 bytes 10:09:45]File: paths.rds                                   [ 62% 2752470 bytes 10:09:45]                                                                               Processing features.rds (0.13kB)
File: paths.rds                                   [ 67% 2752470 bytes 10:09:45]File: paths.rds                                   [ 67% 2752602 bytes 10:09:45]                                                                               Processing hsearch.rds (22.97kB)
File: paths.rds                                   [ 71% 2752602 bytes 10:09:45]File: paths.rds                                   [ 71% 2776120 bytes 10:09:45]                                                                               Processing links.rds (13.26kB)
File: paths.rds                                   [ 75% 2776120 bytes 10:09:45]File: paths.rds                                   [ 75% 2789700 bytes 10:09:45]                                                                               Processing package.rds (0.57kB)
File: paths.rds                                   [ 79% 2789700 bytes 10:09:45]File: paths.rds                                   [ 79% 2790280 bytes 10:09:45]                                                                               Processing Rd.rds (22.15kB)
File: paths.rds                                   [ 83% 2790280 bytes 10:09:45]File: paths.rds                                   [ 83% 2812966 bytes 10:09:45]                                                                               Processing base (5.32kB)
File: base                                        [ 88% 2812966 bytes 10:09:45]File: base                                        [ 88% 2818415 bytes 10:09:45]                                                                               Processing base.rdb (1072.21kB)
File: base                                        [ 92% 2818415 bytes 10:09:45]File: base                                        [ 92% 3916354 bytes 10:09:45]                                                                               Processing base.rdx (13.75kB)
File: base                                        [ 96% 3916354 bytes 10:09:45]File: base                                        [ 96% 3930431 bytes 10:09:45]                                                                               Processing Rprofile (6.91kB)
File: Rprofile                                    [100% 3930431 bytes 10:09:45]File: Rprofile                                    [100% 3937508 bytes 10:09:45]> setLabel(sb, "file", "<done>")
> update(sb)
File: <done>                                      [100% 3937508 bytes 10:09:45]> cat("\n")

> 
> ## Odds and ends
> print(getLabel(sb, "progress"))
[1] 100
> print(newline(sb))

NULL
> updateLabels(sb)
File: <done>                                      [100% 3937508 bytes 10:09:45]> 
> 
