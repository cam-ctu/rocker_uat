
R version 4.3.2 (2023-10-31) -- "Eye Holes"
Copyright (C) 2023 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library("matrixStats")
> 
> fcns <- list(
+   weightedVar = weightedVar,
+   weightedSd  = weightedSd,
+   weightedMad = weightedMad
+ )
> 
> for (name in names(fcns)) {
+   cat(sprintf("%s()...\n", name))
+   fcn <- fcns[[name]]
+ 
+   for (mode in c("integer", "double")) {
+     cat("mode: ", mode, "\n", sep = "")
+     n <- 15L
+     x <- runif(n, min = -5, max = 5)
+     storage.mode(x) <- mode
+     str(x)
+ 
+     for (add_na in c(FALSE, TRUE)) {
+       cat("add_na: ", add_na, "\n", sep = "")
+       if (add_na) {
+         x[c(5, 7)] <- NA
+       }
+       str(x)
+ 
+       for (na.rm in c(FALSE, TRUE)) {
+         cat("na.rm: ", na.rm, "\n", sep = "")
+ 
+         cat("Weights are not specified (all are 1)\n")
+         m1 <- fcn(x, na.rm = na.rm)
+         str(list(m1 = m1))
+ 
+         cat("All weights are 1\n")
+         w <- rep(1, times = n)
+         m1 <- fcn(x, w, na.rm = na.rm)
+         str(list(m1 = m1))
+ 
+         cat("First weight is 5\n")
+         # Pull the mean towards zero
+         w[1] <- 5
+         str(w)
+         m1 <- fcn(x, w, na.rm = na.rm)
+         str(list(m1 = m1))
+ 
+         cat("All weights are 0\n")
+         # All weights set to zero
+         w <- rep(0, times = n)
+         m1 <- fcn(x, w, na.rm = na.rm)
+         str(list(m1 = m1))
+ 
+         cat("First weight is 8.5\n")
+         # Put even more weight on the zero
+         w[1] <- 8.5
+         m1 <- fcn(x, w, na.rm = na.rm)
+         str(list(m1 = m1))
+ 
+         cat("First weight is Inf\n")
+         # All weight on the first value
+         w[1] <- Inf
+         m1 <- fcn(x, w, na.rm = na.rm)
+         str(list(m1 = m1))
+ 
+         cat("Last weight is Inf\n")
+         # All weight on the last value
+         w[1] <- 1
+         w[n] <- Inf
+         m1 <- fcn(x, w, na.rm = na.rm)
+         str(list(m1 = m1))
+ 
+         cat("Last weight is NA\n")
+         # All weight on the last value
+         w[1] <- 1
+         w[n] <- NA_real_
+         m1 <- fcn(x, w, na.rm = na.rm)
+         str(list(m1 = m1))
+       } # for (na.rm ...)
+     } # for (add_na ...)
+   } # for (mode ...)
+ 
+   cat(sprintf("%s()...DONE\n", name))
+ } # for (name ...)
weightedVar()...
mode: integer
 int [1:15] -3 0 2 2 2 0 2 1 2 -1 ...
add_na: FALSE
 int [1:15] -3 0 2 2 2 0 2 1 2 -1 ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: num 3.12
All weights are 1
List of 1
 $ m1: num 3.12
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 4.62
All weights are 0
List of 1
 $ m1: int NA
First weight is 8.5
List of 1
 $ m1: int NA
First weight is Inf
List of 1
 $ m1: int NA
Last weight is Inf
List of 1
 $ m1: int NA
Last weight is NA
List of 1
 $ m1: int NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 3.12
All weights are 1
List of 1
 $ m1: num 3.12
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 4.62
All weights are 0
List of 1
 $ m1: int NA
First weight is 8.5
List of 1
 $ m1: int NA
First weight is Inf
List of 1
 $ m1: int NA
Last weight is Inf
List of 1
 $ m1: int NA
Last weight is NA
List of 1
 $ m1: int NA
add_na: TRUE
 int [1:15] -3 0 2 2 NA 0 NA 1 2 -1 ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: int NA
All weights are 1
List of 1
 $ m1: int NA
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: int NA
All weights are 0
List of 1
 $ m1: int NA
First weight is 8.5
List of 1
 $ m1: int NA
First weight is Inf
List of 1
 $ m1: int NA
Last weight is Inf
List of 1
 $ m1: int NA
Last weight is NA
List of 1
 $ m1: int NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 3.23
All weights are 1
List of 1
 $ m1: num 3.23
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 4.51
All weights are 0
List of 1
 $ m1: int NA
First weight is 8.5
List of 1
 $ m1: int NA
First weight is Inf
List of 1
 $ m1: int NA
Last weight is Inf
List of 1
 $ m1: int NA
Last weight is NA
List of 1
 $ m1: int NA
mode: double
 num [1:15] 3.86 -2.07 2.42 2.56 3.48 ...
add_na: FALSE
 num [1:15] 3.86 -2.07 2.42 2.56 3.48 ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: num 11.3
All weights are 1
List of 1
 $ m1: num 11.3
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 10.9
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 11.3
All weights are 1
List of 1
 $ m1: num 11.3
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 10.9
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
add_na: TRUE
 num [1:15] 3.86 -2.07 2.42 2.56 NA ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: num NA
All weights are 1
List of 1
 $ m1: num NA
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num NA
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 11.6
All weights are 1
List of 1
 $ m1: num 11.6
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 11
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
weightedVar()...DONE
weightedSd()...
mode: integer
 int [1:15] 2 -3 -2 0 0 -4 -3 2 0 3 ...
add_na: FALSE
 int [1:15] 2 -3 -2 0 0 -4 -3 2 0 3 ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: num 2.33
All weights are 1
List of 1
 $ m1: num 2.33
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 2.38
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 2.33
All weights are 1
List of 1
 $ m1: num 2.33
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 2.38
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
add_na: TRUE
 int [1:15] 2 -3 -2 0 NA -4 NA 2 0 3 ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: num NA
All weights are 1
List of 1
 $ m1: num NA
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num NA
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 2.42
All weights are 1
List of 1
 $ m1: num 2.42
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 2.42
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
mode: double
 num [1:15] 0.0733 -1.2934 -4.0492 4.4547 -0.6707 ...
add_na: FALSE
 num [1:15] 0.0733 -1.2934 -4.0492 4.4547 -0.6707 ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: num 3.06
All weights are 1
List of 1
 $ m1: num 3.06
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 2.7
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 3.06
All weights are 1
List of 1
 $ m1: num 3.06
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 2.7
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
add_na: TRUE
 num [1:15] 0.0733 -1.2934 -4.0492 4.4547 NA ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: num NA
All weights are 1
List of 1
 $ m1: num NA
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num NA
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 3.09
All weights are 1
List of 1
 $ m1: num 3.09
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 2.68
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
weightedSd()...DONE
weightedMad()...
mode: integer
 int [1:15] 0 -4 0 1 4 3 2 1 -3 -1 ...
add_na: FALSE
 int [1:15] 0 -4 0 1 4 3 2 1 -3 -1 ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: num 2.97
All weights are 1
List of 1
 $ m1: num 2.97
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 1.48
All weights are 0
List of 1
 $ m1: int NA
First weight is 8.5
List of 1
 $ m1: int 0
First weight is Inf
List of 1
 $ m1: int 0
Last weight is Inf
List of 1
 $ m1: int 0
Last weight is NA
List of 1
 $ m1: int NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 2.97
All weights are 1
List of 1
 $ m1: num 2.97
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 1.48
All weights are 0
List of 1
 $ m1: int NA
First weight is 8.5
List of 1
 $ m1: int 0
First weight is Inf
List of 1
 $ m1: int 0
Last weight is Inf
List of 1
 $ m1: int 0
Last weight is NA
List of 1
 $ m1: int NA
add_na: TRUE
 int [1:15] 0 -4 0 1 NA 3 NA 1 -3 -1 ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: num NA
All weights are 1
List of 1
 $ m1: int NA
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: int NA
All weights are 0
List of 1
 $ m1: int NA
First weight is 8.5
List of 1
 $ m1: int 0
First weight is Inf
List of 1
 $ m1: int 0
Last weight is Inf
List of 1
 $ m1: int 0
Last weight is NA
List of 1
 $ m1: int NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 2.97
All weights are 1
List of 1
 $ m1: num 2.97
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 1.48
All weights are 0
List of 1
 $ m1: int NA
First weight is 8.5
List of 1
 $ m1: int 0
First weight is Inf
List of 1
 $ m1: int 0
Last weight is Inf
List of 1
 $ m1: int 0
Last weight is NA
List of 1
 $ m1: int NA
mode: double
 num [1:15] -3.94 -3.12 3.54 4.95 4.18 ...
add_na: FALSE
 num [1:15] -3.94 -3.12 3.54 4.95 4.18 ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: num 3.93
All weights are 1
List of 1
 $ m1: num 3.93
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 4.63
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num 0
First weight is Inf
List of 1
 $ m1: num 0
Last weight is Inf
List of 1
 $ m1: num 0
Last weight is NA
List of 1
 $ m1: num NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 3.93
All weights are 1
List of 1
 $ m1: num 3.93
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 4.63
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num 0
First weight is Inf
List of 1
 $ m1: num 0
Last weight is Inf
List of 1
 $ m1: num 0
Last weight is NA
List of 1
 $ m1: num NA
add_na: TRUE
 num [1:15] -3.94 -3.12 3.54 4.95 NA ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: num NA
All weights are 1
List of 1
 $ m1: num NA
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num NA
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num 0
First weight is Inf
List of 1
 $ m1: num 0
Last weight is Inf
List of 1
 $ m1: num 0
Last weight is NA
List of 1
 $ m1: num NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 4.31
All weights are 1
List of 1
 $ m1: num 4.31
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 3.38
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num 0
First weight is Inf
List of 1
 $ m1: num 0
Last weight is Inf
List of 1
 $ m1: num 0
Last weight is NA
List of 1
 $ m1: num NA
weightedMad()...DONE
> 
