
R version 4.3.3 (2024-02-29) -- "Angel Food Cake"
Copyright (C) 2024 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> source("incl/start.R")
> stopCluster <- parallel::stopCluster
> 
> message("*** cluster operations ...")
*** cluster operations ...
> 
> local({
+   cl0 <- makeClusterPSOCK(1L)
+   on.exit(stopCluster(cl0))
+   cl <- cl0
+   print(cl)
+ 
+   message("*** cluster operations - as.cluster() ...")
+   cl1 <- as.cluster(cl)
+   print(cl1)
+   stopifnot(inherits(cl1, "cluster"), identical(cl1, cl))
+ 
+   node <- cl[[1]]
+   print(node)
+   cl2 <- as.cluster(node)
+   stopifnot(inherits(cl2, "cluster"), length(cl2) == 1L,
+             identical(cl2[[1]], node))
+ 
+   node <- cl[[1]]
+   print(node)
+   stopifnot(inherits(node, if (useXDR) "SOCKnode" else "SOCK0node"))
+   nodes <- list(node, node)
+   cl3 <- as.cluster(node)
+   print(cl3)
+   stopifnot(inherits(cl3, "cluster"), length(cl3) == 1L,
+             identical(cl3[[1]], node))
+ 
+   cl4 <- as.cluster(nodes)
+   print(cl4)
+   stopifnot(inherits(cl4, "cluster"), length(cl4) == 2L,
+             identical(cl4[[1]], node), identical(cl4[[2]], node))
+   
+   message("*** cluster operations - as.cluster() ... DONE")
+ 
+   message("*** cluster operations - c(...) ...")
+   cl2 <- makeClusterPSOCK("localhost")
+   on.exit(stopCluster(cl2), add = TRUE)
+   print(cl2)
+   
+   cl <- c(cl1, cl2)
+   print(cl)
+ 
+   stopifnot(inherits(cl, "cluster"), length(cl) == 2L)
+   stopifnot(identical(cl[1], cl1),
+             identical(cl[2], cl2[1]))
+   message("*** cluster operations - c(...) ... DONE")
+ })
[11:04:58.522] [local output] makeClusterPSOCK() ...
[11:04:58.557] [local output] Workers: [n = 1] ‘localhost’
[11:04:58.559] [local output] Base port: 11496
[11:04:58.559] [local output] Getting setup options for 1 cluster nodes ...
[11:04:58.559] [local output]  - Node 1 of 1 ...
[11:04:58.559] [local output] localMachine=TRUE => revtunnel=FALSE

[11:04:58.560] Testing if worker's PID can be inferred: ‘'/usr/local/lib/R/bin/Rscript' -e 'try(suppressWarnings(cat(Sys.getpid(),file="/tmp/Rtmp0nPm7n/worker.rank=1.parallelly.parent=105376.19ba050a3a2c1.pid")), silent = TRUE)' -e 'file.exists("/tmp/Rtmp0nPm7n/worker.rank=1.parallelly.parent=105376.19ba050a3a2c1.pid")'’
[11:04:58.749] - Possible to infer worker's PID: TRUE
[11:04:58.750] [local output] Rscript port: 11496

[11:04:58.750] [local output] Getting setup options for 1 cluster nodes ... done
[11:04:58.750] [local output]  - Parallel setup requested for some PSOCK nodes
[11:04:58.751] [local output] Setting up PSOCK nodes in parallel
[11:04:58.751] List of 36
[11:04:58.751]  $ worker          : chr "localhost"
[11:04:58.751]   ..- attr(*, "localhost")= logi TRUE
[11:04:58.751]  $ master          : chr "localhost"
[11:04:58.751]  $ port            : int 11496
[11:04:58.751]  $ connectTimeout  : num 120
[11:04:58.751]  $ timeout         : num 2592000
[11:04:58.751]  $ rscript         : chr "'/usr/local/lib/R/bin/Rscript'"
[11:04:58.751]  $ homogeneous     : logi TRUE
[11:04:58.751]  $ rscript_args    : chr "--default-packages=datasets,utils,grDevices,graphics,stats,methods -e 'try(suppressWarnings(cat(Sys.getpid(),fi"| __truncated__
[11:04:58.751]  $ rscript_envs    : NULL
[11:04:58.751]  $ rscript_libs    : NULL
[11:04:58.751]  $ rscript_startup : NULL
[11:04:58.751]  $ rscript_sh      : chr "sh"
[11:04:58.751]  $ default_packages: chr [1:6] "datasets" "utils" "grDevices" "graphics" ...
[11:04:58.751]  $ methods         : logi TRUE
[11:04:58.751]  $ socketOptions   : chr "no-delay"
[11:04:58.751]  $ useXDR          : logi FALSE
[11:04:58.751]  $ outfile         : chr "/dev/null"
[11:04:58.751]  $ renice          : int NA
[11:04:58.751]  $ rshcmd          : NULL
[11:04:58.751]  $ user            : chr(0) 
[11:04:58.751]  $ revtunnel       : logi FALSE
[11:04:58.751]  $ rshlogfile      : NULL
[11:04:58.751]  $ rshopts         : chr(0) 
[11:04:58.751]  $ rank            : int 1
[11:04:58.751]  $ manual          : logi FALSE
[11:04:58.751]  $ dryrun          : logi FALSE
[11:04:58.751]  $ quiet           : logi FALSE
[11:04:58.751]  $ setup_strategy  : chr "parallel"
[11:04:58.751]  $ local_cmd       : chr "'/usr/local/lib/R/bin/Rscript' --default-packages=datasets,utils,grDevices,graphics,stats,methods -e 'try(suppr"| __truncated__
[11:04:58.751]  $ pidfile         : chr "/tmp/Rtmp0nPm7n/worker.rank=1.parallelly.parent=105376.19ba050a3a2c1.pid"
[11:04:58.751]  $ rshcmd_label    : NULL
[11:04:58.751]  $ rsh_call        : NULL
[11:04:58.751]  $ cmd             : chr "'/usr/local/lib/R/bin/Rscript' --default-packages=datasets,utils,grDevices,graphics,stats,methods -e 'try(suppr"| __truncated__
[11:04:58.751]  $ localMachine    : logi TRUE
[11:04:58.751]  $ make_fcn        :function (worker = getOption2("parallelly.localhost.hostname", "localhost"), 
[11:04:58.751]     master = NULL, port, connectTimeout = getOption2("parallelly.makeNodePSOCK.connectTimeout", 
[11:04:58.751]         2 * 60), timeout = getOption2("parallelly.makeNodePSOCK.timeout", 
[11:04:58.751]         30 * 24 * 60 * 60), rscript = NULL, homogeneous = NULL, rscript_args = NULL, 
[11:04:58.751]     rscript_envs = NULL, rscript_libs = NULL, rscript_startup = NULL, rscript_sh = c("auto", 
[11:04:58.751]         "cmd", "sh"), default_packages = c("datasets", "utils", "grDevices", 
[11:04:58.751]         "graphics", "stats", if (methods) "methods"), methods = TRUE, socketOptions = getOption2("parallelly.makeNodePSOCK.socketOptions", 
[11:04:58.751]         "no-delay"), useXDR = getOption2("parallelly.makeNodePSOCK.useXDR", 
[11:04:58.751]         FALSE), outfile = "/dev/null", renice = NA_integer_, rshcmd = getOption2("parallelly.makeNodePSOCK.rshcmd", 
[11:04:58.751]         NULL), user = NULL, revtunnel = NA, rshlogfile = NULL, rshopts = getOption2("parallelly.makeNodePSOCK.rshopts", 
[11:04:58.751]         NULL), rank = 1L, manual = FALSE, dryrun = FALSE, quiet = FALSE, 
[11:04:58.751]     setup_strategy = getOption2("parallelly.makeNodePSOCK.setup_strategy", 
[11:04:58.751]         "parallel"), action = c("launch", "options"), verbose = FALSE)  
[11:04:58.751]  $ arguments       :List of 28
[11:04:58.751]   ..$ worker          : chr "localhost"
[11:04:58.751]   ..$ master          : NULL
[11:04:58.751]   ..$ port            : int 11496
[11:04:58.751]   ..$ connectTimeout  : num 120
[11:04:58.751]   ..$ timeout         : num 2592000
[11:04:58.751]   ..$ rscript         : NULL
[11:04:58.751]   ..$ homogeneous     : NULL
[11:04:58.751]   ..$ rscript_args    : NULL
[11:04:58.751]   ..$ rscript_envs    : NULL
[11:04:58.751]   ..$ rscript_libs    : NULL
[11:04:58.751]   ..$ rscript_startup : NULL
[11:04:58.751]   ..$ rscript_sh      : chr [1:3] "auto" "cmd" "sh"
[11:04:58.751]   ..$ default_packages: chr [1:6] "datasets" "utils" "grDevices" "graphics" ...
[11:04:58.751]   ..$ methods         : logi TRUE
[11:04:58.751]   ..$ socketOptions   : chr "no-delay"
[11:04:58.751]   ..$ useXDR          : logi FALSE
[11:04:58.751]   ..$ outfile         : chr "/dev/null"
[11:04:58.751]   ..$ renice          : int NA
[11:04:58.751]   ..$ rshcmd          : NULL
[11:04:58.751]   ..$ user            : NULL
[11:04:58.751]   ..$ revtunnel       : logi NA
[11:04:58.751]   ..$ rshlogfile      : NULL
[11:04:58.751]   ..$ rshopts         : NULL
[11:04:58.751]   ..$ rank            : int 1
[11:04:58.751]   ..$ manual          : logi FALSE
[11:04:58.751]   ..$ dryrun          : logi FALSE
[11:04:58.751]   ..$ quiet           : logi FALSE
[11:04:58.751]   ..$ setup_strategy  : chr "parallel"
[11:04:58.751]  - attr(*, "class")= chr [1:2] "makeNodePSOCKOptions" "makeNodeOptions"
[11:04:58.770] [local output] System call to launch all workers:
[11:04:58.770] [local output] '/usr/local/lib/R/bin/Rscript' --default-packages=datasets,utils,grDevices,graphics,stats,methods -e 'try(suppressWarnings(cat(Sys.getpid(),file="/tmp/Rtmp0nPm7n/worker.rank=1.parallelly.parent=105376.19ba050a3a2c1.pid")), silent = TRUE)' -e 'options(socketOptions = "no-delay")' -e 'workRSOCK <- tryCatch(parallel:::.workRSOCK, error=function(e) parallel:::.slaveRSOCK); workRSOCK()' MASTER=localhost PORT=11496 OUT=/dev/null TIMEOUT=2592000 XDR=FALSE SETUPTIMEOUT=120 SETUPSTRATEGY=parallel
[11:04:58.770] [local output] Starting PSOCK main server
[11:04:58.776] [local output] Workers launched
[11:04:58.776] [local output] Waiting for workers to connect back
[11:04:58.776]  - [local output] 0 workers out of 1 ready
[11:04:58.970]  - [local output] 0 workers out of 1 ready
[11:04:58.971]  - [local output] 1 workers out of 1 ready
[11:04:58.971] [local output] Launching of workers completed
[11:04:58.971] [local output] Collecting session information from workers
[11:04:58.972] [local output]  - Worker #1 of 1
[11:04:58.972] [local output] makeClusterPSOCK() ... done
Socket cluster with 1 nodes where 1 node is on host ‘localhost’ (R version 4.3.3 (2024-02-29), platform x86_64-pc-linux-gnu)
*** cluster operations - as.cluster() ...
Socket cluster with 1 nodes where 1 node is on host ‘localhost’ (R version 4.3.3 (2024-02-29), platform x86_64-pc-linux-gnu)
RichSOCKnode of a socket cluster on local host 'localhost' with pid 105427 (R version 4.3.3 (2024-02-29), x86_64-pc-linux-gnu) using socket connection #4 ('<-localhost:11496')
RichSOCKnode of a socket cluster on local host 'localhost' with pid 105427 (R version 4.3.3 (2024-02-29), x86_64-pc-linux-gnu) using socket connection #4 ('<-localhost:11496')
Socket cluster with 1 nodes where 1 node is on host ‘localhost’ (R version 4.3.3 (2024-02-29), platform x86_64-pc-linux-gnu)
Warning: The combined cluster contains 1 duplicated nodes
Socket cluster with 2 nodes where 2 nodes are on host ‘localhost’ (R version 4.3.3 (2024-02-29), platform x86_64-pc-linux-gnu)
*** cluster operations - as.cluster() ... DONE
*** cluster operations - c(...) ...
[11:04:58.980] [local output] makeClusterPSOCK() ...
[11:04:58.980] [local output] Workers: [n = 1] ‘localhost’
[11:04:58.981] [local output] Base port: 11951
[11:04:58.981] [local output] Getting setup options for 1 cluster nodes ...
[11:04:58.981] [local output]  - Node 1 of 1 ...
[11:04:58.981] [local output] localMachine=TRUE => revtunnel=FALSE

[11:04:58.982] [local output] Rscript port: 11951

[11:04:58.982] [local output] Getting setup options for 1 cluster nodes ... done
[11:04:58.982] [local output]  - Parallel setup requested for some PSOCK nodes
[11:04:58.982] [local output] Setting up PSOCK nodes in parallel
[11:04:58.983] List of 36
[11:04:58.983]  $ worker          : chr "localhost"
[11:04:58.983]   ..- attr(*, "localhost")= logi TRUE
[11:04:58.983]  $ master          : chr "localhost"
[11:04:58.983]  $ port            : int 11951
[11:04:58.983]  $ connectTimeout  : num 120
[11:04:58.983]  $ timeout         : num 2592000
[11:04:58.983]  $ rscript         : chr "'/usr/local/lib/R/bin/Rscript'"
[11:04:58.983]  $ homogeneous     : logi TRUE
[11:04:58.983]  $ rscript_args    : chr "--default-packages=datasets,utils,grDevices,graphics,stats,methods -e 'try(suppressWarnings(cat(Sys.getpid(),fi"| __truncated__
[11:04:58.983]  $ rscript_envs    : NULL
[11:04:58.983]  $ rscript_libs    : NULL
[11:04:58.983]  $ rscript_startup : NULL
[11:04:58.983]  $ rscript_sh      : chr "sh"
[11:04:58.983]  $ default_packages: chr [1:6] "datasets" "utils" "grDevices" "graphics" ...
[11:04:58.983]  $ methods         : logi TRUE
[11:04:58.983]  $ socketOptions   : chr "no-delay"
[11:04:58.983]  $ useXDR          : logi FALSE
[11:04:58.983]  $ outfile         : chr "/dev/null"
[11:04:58.983]  $ renice          : int NA
[11:04:58.983]  $ rshcmd          : NULL
[11:04:58.983]  $ user            : chr(0) 
[11:04:58.983]  $ revtunnel       : logi FALSE
[11:04:58.983]  $ rshlogfile      : NULL
[11:04:58.983]  $ rshopts         : chr(0) 
[11:04:58.983]  $ rank            : int 1
[11:04:58.983]  $ manual          : logi FALSE
[11:04:58.983]  $ dryrun          : logi FALSE
[11:04:58.983]  $ quiet           : logi FALSE
[11:04:58.983]  $ setup_strategy  : chr "parallel"
[11:04:58.983]  $ local_cmd       : chr "'/usr/local/lib/R/bin/Rscript' --default-packages=datasets,utils,grDevices,graphics,stats,methods -e 'try(suppr"| __truncated__
[11:04:58.983]  $ pidfile         : chr "/tmp/Rtmp0nPm7n/worker.rank=1.parallelly.parent=105376.19ba03f9aeda2.pid"
[11:04:58.983]  $ rshcmd_label    : NULL
[11:04:58.983]  $ rsh_call        : NULL
[11:04:58.983]  $ cmd             : chr "'/usr/local/lib/R/bin/Rscript' --default-packages=datasets,utils,grDevices,graphics,stats,methods -e 'try(suppr"| __truncated__
[11:04:58.983]  $ localMachine    : logi TRUE
[11:04:58.983]  $ make_fcn        :function (worker = getOption2("parallelly.localhost.hostname", "localhost"), 
[11:04:58.983]     master = NULL, port, connectTimeout = getOption2("parallelly.makeNodePSOCK.connectTimeout", 
[11:04:58.983]         2 * 60), timeout = getOption2("parallelly.makeNodePSOCK.timeout", 
[11:04:58.983]         30 * 24 * 60 * 60), rscript = NULL, homogeneous = NULL, rscript_args = NULL, 
[11:04:58.983]     rscript_envs = NULL, rscript_libs = NULL, rscript_startup = NULL, rscript_sh = c("auto", 
[11:04:58.983]         "cmd", "sh"), default_packages = c("datasets", "utils", "grDevices", 
[11:04:58.983]         "graphics", "stats", if (methods) "methods"), methods = TRUE, socketOptions = getOption2("parallelly.makeNodePSOCK.socketOptions", 
[11:04:58.983]         "no-delay"), useXDR = getOption2("parallelly.makeNodePSOCK.useXDR", 
[11:04:58.983]         FALSE), outfile = "/dev/null", renice = NA_integer_, rshcmd = getOption2("parallelly.makeNodePSOCK.rshcmd", 
[11:04:58.983]         NULL), user = NULL, revtunnel = NA, rshlogfile = NULL, rshopts = getOption2("parallelly.makeNodePSOCK.rshopts", 
[11:04:58.983]         NULL), rank = 1L, manual = FALSE, dryrun = FALSE, quiet = FALSE, 
[11:04:58.983]     setup_strategy = getOption2("parallelly.makeNodePSOCK.setup_strategy", 
[11:04:58.983]         "parallel"), action = c("launch", "options"), verbose = FALSE)  
[11:04:58.983]  $ arguments       :List of 28
[11:04:58.983]   ..$ worker          : chr "localhost"
[11:04:58.983]   ..$ master          : NULL
[11:04:58.983]   ..$ port            : int 11951
[11:04:58.983]   ..$ connectTimeout  : num 120
[11:04:58.983]   ..$ timeout         : num 2592000
[11:04:58.983]   ..$ rscript         : NULL
[11:04:58.983]   ..$ homogeneous     : NULL
[11:04:58.983]   ..$ rscript_args    : NULL
[11:04:58.983]   ..$ rscript_envs    : NULL
[11:04:58.983]   ..$ rscript_libs    : NULL
[11:04:58.983]   ..$ rscript_startup : NULL
[11:04:58.983]   ..$ rscript_sh      : chr [1:3] "auto" "cmd" "sh"
[11:04:58.983]   ..$ default_packages: chr [1:6] "datasets" "utils" "grDevices" "graphics" ...
[11:04:58.983]   ..$ methods         : logi TRUE
[11:04:58.983]   ..$ socketOptions   : chr "no-delay"
[11:04:58.983]   ..$ useXDR          : logi FALSE
[11:04:58.983]   ..$ outfile         : chr "/dev/null"
[11:04:58.983]   ..$ renice          : int NA
[11:04:58.983]   ..$ rshcmd          : NULL
[11:04:58.983]   ..$ user            : NULL
[11:04:58.983]   ..$ revtunnel       : logi NA
[11:04:58.983]   ..$ rshlogfile      : NULL
[11:04:58.983]   ..$ rshopts         : NULL
[11:04:58.983]   ..$ rank            : int 1
[11:04:58.983]   ..$ manual          : logi FALSE
[11:04:58.983]   ..$ dryrun          : logi FALSE
[11:04:58.983]   ..$ quiet           : logi FALSE
[11:04:58.983]   ..$ setup_strategy  : chr "parallel"
[11:04:58.983]  - attr(*, "class")= chr [1:2] "makeNodePSOCKOptions" "makeNodeOptions"
[11:04:59.001] [local output] System call to launch all workers:
[11:04:59.001] [local output] '/usr/local/lib/R/bin/Rscript' --default-packages=datasets,utils,grDevices,graphics,stats,methods -e 'try(suppressWarnings(cat(Sys.getpid(),file="/tmp/Rtmp0nPm7n/worker.rank=1.parallelly.parent=105376.19ba03f9aeda2.pid")), silent = TRUE)' -e 'options(socketOptions = "no-delay")' -e 'workRSOCK <- tryCatch(parallel:::.workRSOCK, error=function(e) parallel:::.slaveRSOCK); workRSOCK()' MASTER=localhost PORT=11951 OUT=/dev/null TIMEOUT=2592000 XDR=FALSE SETUPTIMEOUT=120 SETUPSTRATEGY=parallel
[11:04:59.001] [local output] Starting PSOCK main server
[11:04:59.002] [local output] Workers launched
[11:04:59.002] [local output] Waiting for workers to connect back
[11:04:59.002]  - [local output] 0 workers out of 1 ready
[11:04:59.199]  - [local output] 0 workers out of 1 ready
[11:04:59.199]  - [local output] 1 workers out of 1 ready
[11:04:59.199] [local output] Launching of workers completed
[11:04:59.200] [local output] Collecting session information from workers
[11:04:59.200] [local output]  - Worker #1 of 1
[11:04:59.200] [local output] makeClusterPSOCK() ... done
Socket cluster with 1 nodes where 1 node is on host ‘localhost’ (R version 4.3.3 (2024-02-29), platform x86_64-pc-linux-gnu)
Socket cluster with 2 nodes where 2 nodes are on host ‘localhost’ (R version 4.3.3 (2024-02-29), platform x86_64-pc-linux-gnu)
*** cluster operations - c(...) ... DONE
> 
> 
> message("*** cluster operations - makeClusterPSOCK(remotes) ...")
*** cluster operations - makeClusterPSOCK(remotes) ...
> 
> remotes <- Sys.getenv("R_PARALLELLY_TESTS_REMOTES", "")
> remotes <- gsub(" ", "", unlist(strsplit(remotes, split = ",")))
> remotes <- remotes[nzchar(remotes)]
> if (length(remotes) > 0) {
+   message("Remotes: ", paste(sQuote(remotes), collapse = ", "))
+   local({
+     cl <- makeClusterPSOCK(remotes, verbose = TRUE)
+     on.exit(stopCluster(cl))
+     print(cl)
+   })
+ }
> 
> message("*** cluster operations - makeClusterPSOCK(remotes) ... DONE")
*** cluster operations - makeClusterPSOCK(remotes) ... DONE
> 
> message("*** cluster operations ... DONE")
*** cluster operations ... DONE
> 
> source("incl/end.R")
> 
