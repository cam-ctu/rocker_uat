
R version 4.5.1 (2025-06-13) -- "Great Square Root"
Copyright (C) 2025 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library("matrixStats")
> 
> fcns <- list(
+   weightedVar = weightedVar,
+   weightedSd  = weightedSd,
+   weightedMad = weightedMad
+ )
> 
> for (name in names(fcns)) {
+   cat(sprintf("%s()...\n", name))
+   fcn <- fcns[[name]]
+ 
+   for (mode in c("integer", "double")) {
+     cat("mode: ", mode, "\n", sep = "")
+     n <- 15L
+     x <- runif(n, min = -5, max = 5)
+     storage.mode(x) <- mode
+     str(x)
+ 
+     for (add_na in c(FALSE, TRUE)) {
+       cat("add_na: ", add_na, "\n", sep = "")
+       if (add_na) {
+         x[c(5, 7)] <- NA
+       }
+       str(x)
+ 
+       for (na.rm in c(FALSE, TRUE)) {
+         cat("na.rm: ", na.rm, "\n", sep = "")
+ 
+         cat("Weights are not specified (all are 1)\n")
+         m1 <- fcn(x, na.rm = na.rm)
+         str(list(m1 = m1))
+ 
+         cat("All weights are 1\n")
+         w <- rep(1, times = n)
+         m1 <- fcn(x, w, na.rm = na.rm)
+         str(list(m1 = m1))
+ 
+         cat("First weight is 5\n")
+         # Pull the mean towards zero
+         w[1] <- 5
+         str(w)
+         m1 <- fcn(x, w, na.rm = na.rm)
+         str(list(m1 = m1))
+ 
+         cat("All weights are 0\n")
+         # All weights set to zero
+         w <- rep(0, times = n)
+         m1 <- fcn(x, w, na.rm = na.rm)
+         str(list(m1 = m1))
+ 
+         cat("First weight is 8.5\n")
+         # Put even more weight on the zero
+         w[1] <- 8.5
+         m1 <- fcn(x, w, na.rm = na.rm)
+         str(list(m1 = m1))
+ 
+         cat("First weight is Inf\n")
+         # All weight on the first value
+         w[1] <- Inf
+         m1 <- fcn(x, w, na.rm = na.rm)
+         str(list(m1 = m1))
+ 
+         cat("Last weight is Inf\n")
+         # All weight on the last value
+         w[1] <- 1
+         w[n] <- Inf
+         m1 <- fcn(x, w, na.rm = na.rm)
+         str(list(m1 = m1))
+ 
+         cat("Last weight is NA\n")
+         # All weight on the last value
+         w[1] <- 1
+         w[n] <- NA_real_
+         m1 <- fcn(x, w, na.rm = na.rm)
+         str(list(m1 = m1))
+       } # for (na.rm ...)
+     } # for (add_na ...)
+   } # for (mode ...)
+ 
+   cat(sprintf("%s()...DONE\n", name))
+ } # for (name ...)
weightedVar()...
mode: integer
 int [1:15] -1 0 -2 0 0 3 -3 4 3 -4 ...
add_na: FALSE
 int [1:15] -1 0 -2 0 0 3 -3 4 3 -4 ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: num 8.54
All weights are 1
List of 1
 $ m1: num 8.54
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 6.99
All weights are 0
List of 1
 $ m1: int NA
First weight is 8.5
List of 1
 $ m1: int NA
First weight is Inf
List of 1
 $ m1: int NA
Last weight is Inf
List of 1
 $ m1: int NA
Last weight is NA
List of 1
 $ m1: int NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 8.54
All weights are 1
List of 1
 $ m1: num 8.54
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 6.99
All weights are 0
List of 1
 $ m1: int NA
First weight is 8.5
List of 1
 $ m1: int NA
First weight is Inf
List of 1
 $ m1: int NA
Last weight is Inf
List of 1
 $ m1: int NA
Last weight is NA
List of 1
 $ m1: int NA
add_na: TRUE
 int [1:15] -1 0 -2 0 NA 3 NA 4 3 -4 ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: int NA
All weights are 1
List of 1
 $ m1: int NA
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: int NA
All weights are 0
List of 1
 $ m1: int NA
First weight is 8.5
List of 1
 $ m1: int NA
First weight is Inf
List of 1
 $ m1: int NA
Last weight is Inf
List of 1
 $ m1: int NA
Last weight is NA
List of 1
 $ m1: int NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 8.9
All weights are 1
List of 1
 $ m1: num 8.9
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 7.22
All weights are 0
List of 1
 $ m1: int NA
First weight is 8.5
List of 1
 $ m1: int NA
First weight is Inf
List of 1
 $ m1: int NA
Last weight is Inf
List of 1
 $ m1: int NA
Last weight is NA
List of 1
 $ m1: int NA
mode: double
 num [1:15] 0.827 2.97 -3.085 4.079 -0.73 ...
add_na: FALSE
 num [1:15] 0.827 2.97 -3.085 4.079 -0.73 ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: num 10.1
All weights are 1
List of 1
 $ m1: num 10.1
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 8.07
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 10.1
All weights are 1
List of 1
 $ m1: num 10.1
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 8.07
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
add_na: TRUE
 num [1:15] 0.827 2.97 -3.085 4.079 NA ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: num NA
All weights are 1
List of 1
 $ m1: num NA
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num NA
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 9.6
All weights are 1
List of 1
 $ m1: num 9.6
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 7.55
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
weightedVar()...DONE
weightedSd()...
mode: integer
 int [1:15] -3 0 -2 4 -3 4 1 3 -3 1 ...
add_na: FALSE
 int [1:15] -3 0 -2 4 -3 4 1 3 -3 1 ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: num 2.58
All weights are 1
List of 1
 $ m1: num 2.58
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 2.67
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 2.58
All weights are 1
List of 1
 $ m1: num 2.58
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 2.67
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
add_na: TRUE
 int [1:15] -3 0 -2 4 NA 4 NA 3 -3 1 ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: num NA
All weights are 1
List of 1
 $ m1: num NA
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num NA
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 2.6
All weights are 1
List of 1
 $ m1: num 2.6
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 2.73
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
mode: double
 num [1:15] 2.496 0.506 0.49 -0.157 0.524 ...
add_na: FALSE
 num [1:15] 2.496 0.506 0.49 -0.157 0.524 ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: num 2.44
All weights are 1
List of 1
 $ m1: num 2.44
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 2.52
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 2.44
All weights are 1
List of 1
 $ m1: num 2.44
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 2.52
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
add_na: TRUE
 num [1:15] 2.496 0.506 0.49 -0.157 NA ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: num NA
All weights are 1
List of 1
 $ m1: num NA
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num NA
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 2.49
All weights are 1
List of 1
 $ m1: num 2.49
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 2.52
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num NA
First weight is Inf
List of 1
 $ m1: num NA
Last weight is Inf
List of 1
 $ m1: num NA
Last weight is NA
List of 1
 $ m1: num NA
weightedSd()...DONE
weightedMad()...
mode: integer
 int [1:15] -1 -1 -4 2 3 4 -4 1 0 -2 ...
add_na: FALSE
 int [1:15] -1 -1 -4 2 3 4 -4 1 0 -2 ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: num 2.97
All weights are 1
List of 1
 $ m1: num 2.97
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 1.48
All weights are 0
List of 1
 $ m1: int NA
First weight is 8.5
List of 1
 $ m1: int 0
First weight is Inf
List of 1
 $ m1: int 0
Last weight is Inf
List of 1
 $ m1: int 0
Last weight is NA
List of 1
 $ m1: int NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 2.97
All weights are 1
List of 1
 $ m1: num 2.97
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 1.48
All weights are 0
List of 1
 $ m1: int NA
First weight is 8.5
List of 1
 $ m1: int 0
First weight is Inf
List of 1
 $ m1: int 0
Last weight is Inf
List of 1
 $ m1: int 0
Last weight is NA
List of 1
 $ m1: int NA
add_na: TRUE
 int [1:15] -1 -1 -4 2 NA 4 NA 1 0 -2 ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: num NA
All weights are 1
List of 1
 $ m1: int NA
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: int NA
All weights are 0
List of 1
 $ m1: int NA
First weight is 8.5
List of 1
 $ m1: int 0
First weight is Inf
List of 1
 $ m1: int 0
Last weight is Inf
List of 1
 $ m1: int 0
Last weight is NA
List of 1
 $ m1: int NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 2.97
All weights are 1
List of 1
 $ m1: num 2.97
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 1.48
All weights are 0
List of 1
 $ m1: int NA
First weight is 8.5
List of 1
 $ m1: int 0
First weight is Inf
List of 1
 $ m1: int 0
Last weight is Inf
List of 1
 $ m1: int 0
Last weight is NA
List of 1
 $ m1: int NA
mode: double
 num [1:15] -3.5 3.09 -3.09 1.14 2.98 ...
add_na: FALSE
 num [1:15] -3.5 3.09 -3.09 1.14 2.98 ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: num 3.75
All weights are 1
List of 1
 $ m1: num 3.75
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 3.39
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num 0
First weight is Inf
List of 1
 $ m1: num 0
Last weight is Inf
List of 1
 $ m1: num 0
Last weight is NA
List of 1
 $ m1: num NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 3.75
All weights are 1
List of 1
 $ m1: num 3.75
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 3.39
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num 0
First weight is Inf
List of 1
 $ m1: num 0
Last weight is Inf
List of 1
 $ m1: num 0
Last weight is NA
List of 1
 $ m1: num NA
add_na: TRUE
 num [1:15] -3.5 3.09 -3.09 1.14 NA ...
na.rm: FALSE
Weights are not specified (all are 1)
List of 1
 $ m1: num NA
All weights are 1
List of 1
 $ m1: num NA
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num NA
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num 0
First weight is Inf
List of 1
 $ m1: num 0
Last weight is Inf
List of 1
 $ m1: num 0
Last weight is NA
List of 1
 $ m1: num NA
na.rm: TRUE
Weights are not specified (all are 1)
List of 1
 $ m1: num 3.57
All weights are 1
List of 1
 $ m1: num 3.57
First weight is 5
 num [1:15] 5 1 1 1 1 1 1 1 1 1 ...
List of 1
 $ m1: num 2.6
All weights are 0
List of 1
 $ m1: num NA
First weight is 8.5
List of 1
 $ m1: num 0
First weight is Inf
List of 1
 $ m1: num 0
Last weight is Inf
List of 1
 $ m1: num 0
Last weight is NA
List of 1
 $ m1: num NA
weightedMad()...DONE
> 
