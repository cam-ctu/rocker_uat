
R version 4.5.1 (2025-06-13) -- "Great Square Root"
Copyright (C) 2025 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> require(tensorA)
Loading required package: tensorA

Attaching package: ‘tensorA’

The following object is masked from ‘package:base’:

    norm

> 
> if(FALSE) {
+   # Commands for testing
+   debugger()
+   options(error=dump.frames)
+   detach("package:tensorA")
+   library(tensorA,lib.loc="../../tensorA.Rcheck")
+ }
> 
> #Aidx(3,4) # c(1,2,3,1,2,3,1,2,3,1,2,3)
> #Bidx(3,4) # c(1,1,1,2,2,2,3,3,3,4,4,4)
> 
> # gsi.eps
> #gsi.eps  # 1E-10
> # gs.setarg
> #tmp <- function(a=2,b=3) {a*b}
> #if( gsi.setarg(tmp,b=5)()!=10 )
> #  stop("Fehler gs.setarg")
>   
> # to.tensor
> to.tensor(c(1,2,3))
[1] 1 2 3
attr(,"class")
[1] "tensor"
> dim(to.tensor(c(1,2,3)))
I 
3 
> 
> set.seed(23)
> 
> A <- to.tensor(1:20,c(U=2,V=2,W=5))
> A
, , 1

      V
U      [,1] [,2]
  [1,]    1    3
  [2,]    2    4

, , 2

      V
U      [,1] [,2]
  [1,]    5    7
  [2,]    6    8

, , 3

      V
U      [,1] [,2]
  [1,]    9   11
  [2,]   10   12

, , 4

      V
U      [,1] [,2]
  [1,]   13   15
  [2,]   14   16

, , 5

      V
U      [,1] [,2]
  [1,]   17   19
  [2,]   18   20

attr(,"class")
[1] "tensor"
> dim(A)
U V W 
2 2 5 
> names(A)
[1] "U" "V" "W"
> dimnames(A)
$U
NULL

$V
NULL

$W
NULL

> 
> ftable(to.tensor(A))
      W W1 W2 W3 W4 W5
U  V                  
U1 V1    1  5  9 13 17
   V2    3  7 11 15 19
U2 V1    2  6 10 14 18
   V2    4  8 12 16 20
> ftable(to.tensor(c(A),dim(A)))
      W W1 W2 W3 W4 W5
U  V                  
U1 V1    1  5  9 13 17
   V2    3  7 11 15 19
U2 V1    2  6 10 14 18
   V2    4  8 12 16 20
> ftable(to.tensor(c(A),dim(A),dimnames(A)))
      W W1 W2 W3 W4 W5
U  V                  
U1 V1    1  5  9 13 17
   V2    3  7 11 15 19
U2 V1    2  6 10 14 18
   V2    4  8 12 16 20
> ftable(to.tensor(A,dim(A),what=1:3))
      W W1 W2 W3 W4 W5
U  V                  
U1 V1    1  5  9 13 17
   V2    3  7 11 15 19
U2 V1    2  6 10 14 18
   V2    4  8 12 16 20
> ftable(to.tensor(A,dim(A)[1:2],dimnames(A)[1:2],1:2))
      W W1 W2 W3 W4 W5
U  V                  
U1 V1    1  5  9 13 17
   V2    3  7 11 15 19
U2 V1    2  6 10 14 18
   V2    4  8 12 16 20
> ftable(to.tensor(A,dim(A)[1],dimnames(A)[1],1,addIndex=TRUE))
            W W1 W2 W3 W4 W5
U  @.I1  V                  
U1 @.I11 V1    1  5  9 13 17
         V2    3  7 11 15 19
U2 @.I11 V1    2  6 10 14 18
         V2    4  8 12 16 20
> 
> 
> Anamed <- A
> #dimnames(Anamed)[["U"]]<- gsi.stdnames(2,"u")
> #dimnames(Anamed)[["V"]]<- gsi.stdnames(2,"v")
> #dimnames(Anamed)[["U"]]<- gsi.stdnames(dim(A)["w"],"w")
> ftable(Anamed)
      W W1 W2 W3 W4 W5
U  V                  
U1 V1    1  5  9 13 17
   V2    3  7 11 15 19
U2 V1    2  6 10 14 18
   V2    4  8 12 16 20
> ftable(to.tensor(Anamed))
      W W1 W2 W3 W4 W5
U  V                  
U1 V1    1  5  9 13 17
   V2    3  7 11 15 19
U2 V1    2  6 10 14 18
   V2    4  8 12 16 20
> ftable(to.tensor(c(Anamed),dim(Anamed)))
      W W1 W2 W3 W4 W5
U  V                  
U1 V1    1  5  9 13 17
   V2    3  7 11 15 19
U2 V1    2  6 10 14 18
   V2    4  8 12 16 20
> ftable(to.tensor(c(Anamed),dim(Anamed),dimnames(Anamed)))
      W W1 W2 W3 W4 W5
U  V                  
U1 V1    1  5  9 13 17
   V2    3  7 11 15 19
U2 V1    2  6 10 14 18
   V2    4  8 12 16 20
> ftable(to.tensor(Anamed,dim(Anamed),what=1:3))
      W W1 W2 W3 W4 W5
U  V                  
U1 V1    1  5  9 13 17
   V2    3  7 11 15 19
U2 V1    2  6 10 14 18
   V2    4  8 12 16 20
> ftable(to.tensor(Anamed,dim(Anamed)[1:2],dimnames(Anamed)[1:2],1:2))
      W W1 W2 W3 W4 W5
U  V                  
U1 V1    1  5  9 13 17
   V2    3  7 11 15 19
U2 V1    2  6 10 14 18
   V2    4  8 12 16 20
> ftable(to.tensor(Anamed,dim(Anamed)[1],dimnames(Anamed)[1],1,addIndex=TRUE))
            W W1 W2 W3 W4 W5
U  @.I1  V                  
U1 @.I11 V1    1  5  9 13 17
         V2    3  7 11 15 19
U2 @.I11 V1    2  6 10 14 18
         V2    4  8 12 16 20
> ftable(to.tensor(Anamed,dim(Anamed)[1],dimnames(Anamed)[1],1,addIndex="I"))
         W W1 W2 W3 W4 W5
U  I  V                  
U1 I1 V1    1  5  9 13 17
      V2    3  7 11 15 19
U2 I1 V1    2  6 10 14 18
      V2    4  8 12 16 20
> 
> 
> B <- to.tensor(1:30,list(U=c("a","b","c"),V=c("B1","B2"),W=1:5))
> B
, , W = 1

   V
U   B1 B2
  a  1  4
  b  2  5
  c  3  6

, , W = 2

   V
U   B1 B2
  a  7 10
  b  8 11
  c  9 12

, , W = 3

   V
U   B1 B2
  a 13 16
  b 14 17
  c 15 18

, , W = 4

   V
U   B1 B2
  a 19 22
  b 20 23
  c 21 24

, , W = 5

   V
U   B1 B2
  a 25 28
  b 26 29
  c 27 30

attr(,"class")
[1] "tensor"
> dim(B)
U V W 
3 2 5 
> names(B)
[1] "U" "V" "W"
> dimnames(B)
$U
[1] "a" "b" "c"

$V
[1] "B1" "B2"

$W
[1] "1" "2" "3" "4" "5"

> 
> B2 <- to.tensor(B,c(x=1,y=3,z=1))
> ftable(B2)
            W  1  2  3  4  5
x  y  z  V                  
x1 y1 z1 B1    1  7 13 19 25
         B2    4 10 16 22 28
   y2 z1 B1    2  8 14 20 26
         B2    5 11 17 23 29
   y3 z1 B1    3  9 15 21 27
         B2    6 12 18 24 30
> 
> 
> C <- to.tensor(1:20,c(A=4,B=5))
> C
      B
A      [,1] [,2] [,3] [,4] [,5]
  [1,]    1    5    9   13   17
  [2,]    2    6   10   14   18
  [3,]    3    7   11   15   19
  [4,]    4    8   12   16   20
attr(,"class")
[1] "tensor" "matrix"
> C <- to.tensor(C,c(A1=2,A2=2))
> C
, , 1

      A2
A1     [,1] [,2]
  [1,]    1    3
  [2,]    2    4

, , 2

      A2
A1     [,1] [,2]
  [1,]    5    7
  [2,]    6    8

, , 3

      A2
A1     [,1] [,2]
  [1,]    9   11
  [2,]   10   12

, , 4

      A2
A1     [,1] [,2]
  [1,]   13   15
  [2,]   14   16

, , 5

      A2
A1     [,1] [,2]
  [1,]   17   19
  [2,]   18   20

attr(,"class")
[1] "tensor"
> D <- C
> C <- to.tensor(C,c(A1=1,A2=4),what=c("A2","A1"))
> C
, , 1

      A2
A1     [,1] [,2] [,3] [,4]
  [1,]    1    3    2    4

, , 2

      A2
A1     [,1] [,2] [,3] [,4]
  [1,]    5    7    6    8

, , 3

      A2
A1     [,1] [,2] [,3] [,4]
  [1,]    9   11   10   12

, , 4

      A2
A1     [,1] [,2] [,3] [,4]
  [1,]   13   15   14   16

, , 5

      A2
A1     [,1] [,2] [,3] [,4]
  [1,]   17   19   18   20

attr(,"class")
[1] "tensor"
> 
> C <- to.tensor(C,c(A1=2),what=c("A2","A1"),addIndex="Q")
> C
, , 1

      Q
A1     [,1] [,2]
  [1,]    1    2
  [2,]    3    4

, , 2

      Q
A1     [,1] [,2]
  [1,]    5    6
  [2,]    7    8

, , 3

      Q
A1     [,1] [,2]
  [1,]    9   10
  [2,]   11   12

, , 4

      Q
A1     [,1] [,2]
  [1,]   13   14
  [2,]   15   16

, , 5

      Q
A1     [,1] [,2]
  [1,]   17   18
  [2,]   19   20

attr(,"class")
[1] "tensor"
> 
> Cnamed <- to.tensor(1:20,c(A=4,B=5))
> dimnames(Cnamed)[["B"]]<-LETTERS[1:5]
> dimnames(Cnamed)[["A"]]<-letters[1:4]
> Cnamed
   B
A   A B  C  D  E
  a 1 5  9 13 17
  b 2 6 10 14 18
  c 3 7 11 15 19
  d 4 8 12 16 20
attr(,"class")
[1] "tensor" "matrix"
> Cnamed <- to.tensor(Cnamed,c(A1=2,A2=2))
> dimnames(Cnamed)
$A1
NULL

$A2
NULL

$B
[1] "A" "B" "C" "D" "E"

> Dnamed <- Cnamed
> Cnamed <- to.tensor(Cnamed,c(A1=1,A2=4),what=c("A2","A1"))
> ftable(Cnamed)
        B  A  B  C  D  E
A1  A2                  
A11 A21    1  5  9 13 17
    A22    3  7 11 15 19
    A23    2  6 10 14 18
    A24    4  8 12 16 20
> 
> Cnamed <- to.tensor(Cnamed,c(A1=2),what=c("A2","A1"),addIndex="Q")
> ftable(Cnamed)
       B  A  B  C  D  E
A1  Q                  
A11 Q1    1  5  9 13 17
    Q2    2  6 10 14 18
A12 Q1    3  7 11 15 19
    Q2    4  8 12 16 20
> 
> 
> 
> # names
> names( C )
[1] "A1" "Q"  "B" 
> names( C ) <- c("A1","A2","A3")
> C
, , 1

      A2
A1     [,1] [,2]
  [1,]    1    2
  [2,]    3    4

, , 2

      A2
A1     [,1] [,2]
  [1,]    5    6
  [2,]    7    8

, , 3

      A2
A1     [,1] [,2]
  [1,]    9   10
  [2,]   11   12

, , 4

      A2
A1     [,1] [,2]
  [1,]   13   14
  [2,]   15   16

, , 5

      A2
A1     [,1] [,2]
  [1,]   17   18
  [2,]   19   20

attr(,"class")
[1] "tensor"
> names(C)
[1] "A1" "A2" "A3"
> 
> names( Cnamed )
[1] "A1" "Q"  "B" 
> names( Cnamed ) <- c("A1","A2","A3")
> ftable(Cnamed)
        A3  A  B  C  D  E
A1  A2                   
A11 A21     1  5  9 13 17
    A22     2  6 10 14 18
A12 A21     3  7 11 15 19
    A22     4  8 12 16 20
> names(Cnamed)
[1] "A1" "A2" "A3"
> 
> 
> # norm
> norm.tensor(C) - sqrt(sum((1:20)^2))
[1] 0
> norm.tensor(Cnamed) - sqrt(sum((1:20)^2))
[1] 0
> 
> # margin.tensor
> margin.tensor(C,"A1")
      A3
A2     [,1] [,2] [,3] [,4] [,5]
  [1,]    4   12   20   28   36
  [2,]    6   14   22   30   38
attr(,"class")
[1] "tensor" "matrix"
> margin.tensor(Cnamed,"A1")
      A3
A2     A  B  C  D  E
  [1,] 4 12 20 28 36
  [2,] 6 14 22 30 38
attr(,"class")
[1] "tensor" "matrix"
> 
> # diagmul.tensor
> norm.tensor( diagmul.tensor(C,D=C)-C^2 ) # 0
[1] 0
> norm.tensor( diagmul.tensor(Cnamed,D=Cnamed)-Cnamed^2 ) # 0
[1] 0
> 
> Cr <- rep.tensor(C,10,1,name="K")
> #norm(diagmul.tensor(Cr,names(C),C,names(C),by="K") - diagmul.tensor(Cr,names(C),D=Cr,names(C),by="K")) # 0
> 
> # pos.tensor
> pos.tensor(dim(C))
      A1 A2 A3
 [1,]  1  1  1
 [2,]  2  1  1
 [3,]  1  2  1
 [4,]  2  2  1
 [5,]  1  1  2
 [6,]  2  1  2
 [7,]  1  2  2
 [8,]  2  2  2
 [9,]  1  1  3
[10,]  2  1  3
[11,]  1  2  3
[12,]  2  2  3
[13,]  1  1  4
[14,]  2  1  4
[15,]  1  2  4
[16,]  2  2  4
[17,]  1  1  5
[18,]  2  1  5
[19,]  1  2  5
[20,]  2  2  5
> 
> # reorder.tensor
> reorder.tensor(C,c(2))
, , 1

      A1
A2     [,1] [,2]
  [1,]    1    3
  [2,]    2    4

, , 2

      A1
A2     [,1] [,2]
  [1,]    5    7
  [2,]    6    8

, , 3

      A1
A2     [,1] [,2]
  [1,]    9   11
  [2,]   10   12

, , 4

      A1
A2     [,1] [,2]
  [1,]   13   15
  [2,]   14   16

, , 5

      A1
A2     [,1] [,2]
  [1,]   17   19
  [2,]   18   20

attr(,"class")
[1] "tensor"
> reorder.tensor(C,c("A3","A2"))
, , 1

      A2
A3     [,1] [,2]
  [1,]    1    2
  [2,]    5    6
  [3,]    9   10
  [4,]   13   14
  [5,]   17   18

, , 2

      A2
A3     [,1] [,2]
  [1,]    3    4
  [2,]    7    8
  [3,]   11   12
  [4,]   15   16
  [5,]   19   20

attr(,"class")
[1] "tensor"
> ftable(reorder.tensor(Cnamed,c(2)))
        A3  A  B  C  D  E
A2  A1                   
A21 A11     1  5  9 13 17
    A12     3  7 11 15 19
A22 A11     2  6 10 14 18
    A12     4  8 12 16 20
> ftable(reorder.tensor(Cnamed,c("A3","A2")))
       A1 A11 A12
A3 A2            
A  A21      1   3
   A22      2   4
B  A21      5   7
   A22      6   8
C  A21      9  11
   A22     10  12
D  A21     13  15
   A22     14  16
E  A21     17  19
   A22     18  20
> 
> # mul.tensor
> AA <- mul.tensor(A,1,mark(A),1)
> AA
, , 1, 1

      W
V      [,1] [,2] [,3] [,4] [,5]
  [1,]    5   17   29   41   53
  [2,]   11   23   35   47   59

, , 2, 1

      W
V      [,1] [,2] [,3] [,4] [,5]
  [1,]   11   39   67   95  123
  [2,]   25   53   81  109  137

, , 1, 2

      W
V      [,1] [,2] [,3] [,4] [,5]
  [1,]   17   61  105  149  193
  [2,]   39   83  127  171  215

, , 2, 2

      W
V      [,1] [,2] [,3] [,4] [,5]
  [1,]   23   83  143  203  263
  [2,]   53  113  173  233  293

, , 1, 3

      W
V      [,1] [,2] [,3] [,4] [,5]
  [1,]   29  105  181  257  333
  [2,]   67  143  219  295  371

, , 2, 3

      W
V      [,1] [,2] [,3] [,4] [,5]
  [1,]   35  127  219  311  403
  [2,]   81  173  265  357  449

, , 1, 4

      W
V      [,1] [,2] [,3] [,4] [,5]
  [1,]   41  149  257  365  473
  [2,]   95  203  311  419  527

, , 2, 4

      W
V      [,1] [,2] [,3] [,4] [,5]
  [1,]   47  171  295  419  543
  [2,]  109  233  357  481  605

, , 1, 5

      W
V      [,1] [,2] [,3] [,4] [,5]
  [1,]   53  193  333  473  613
  [2,]  123  263  403  543  683

, , 2, 5

      W
V      [,1] [,2] [,3] [,4] [,5]
  [1,]   59  215  371  527  683
  [2,]  137  293  449  605  761

attr(,"class")
[1] "tensor"
> dim(AA)
 V  W V' W' 
 2  5  2  5 
> 
> AA <- mul.tensor(Anamed,1,mark(Anamed),1)
> ftable(AA)
          W' W'1 W'2 W'3 W'4 W'5
V  W  V'                        
V1 W1 V'1      5  17  29  41  53
      V'2     11  23  35  47  59
   W2 V'1     17  61 105 149 193
      V'2     39  83 127 171 215
   W3 V'1     29 105 181 257 333
      V'2     67 143 219 295 371
   W4 V'1     41 149 257 365 473
      V'2     95 203 311 419 527
   W5 V'1     53 193 333 473 613
      V'2    123 263 403 543 683
V2 W1 V'1     11  39  67  95 123
      V'2     25  53  81 109 137
   W2 V'1     23  83 143 203 263
      V'2     53 113 173 233 293
   W3 V'1     35 127 219 311 403
      V'2     81 173 265 357 449
   W4 V'1     47 171 295 419 543
      V'2    109 233 357 481 605
   W5 V'1     59 215 371 527 683
      V'2    137 293 449 605 761
> dim(AA)
 V  W V' W' 
 2  5  2  5 
> 
> A <- to.tensor(as.complex(1:20),c(U=2,V=2,W=5))
> AA <- mul.tensor(A,1,mark(A),1)
> 
> 
> #
> 
> 
> # rep.tensor
> rep(A,3,name="Q",pos=4)
, , 1, 1

      V
U      [,1] [,2]
  [1,] 1+0i 3+0i
  [2,] 2+0i 4+0i

, , 2, 1

      V
U      [,1] [,2]
  [1,] 5+0i 7+0i
  [2,] 6+0i 8+0i

, , 3, 1

      V
U       [,1]  [,2]
  [1,]  9+0i 11+0i
  [2,] 10+0i 12+0i

, , 4, 1

      V
U       [,1]  [,2]
  [1,] 13+0i 15+0i
  [2,] 14+0i 16+0i

, , 5, 1

      V
U       [,1]  [,2]
  [1,] 17+0i 19+0i
  [2,] 18+0i 20+0i

, , 1, 2

      V
U      [,1] [,2]
  [1,] 1+0i 3+0i
  [2,] 2+0i 4+0i

, , 2, 2

      V
U      [,1] [,2]
  [1,] 5+0i 7+0i
  [2,] 6+0i 8+0i

, , 3, 2

      V
U       [,1]  [,2]
  [1,]  9+0i 11+0i
  [2,] 10+0i 12+0i

, , 4, 2

      V
U       [,1]  [,2]
  [1,] 13+0i 15+0i
  [2,] 14+0i 16+0i

, , 5, 2

      V
U       [,1]  [,2]
  [1,] 17+0i 19+0i
  [2,] 18+0i 20+0i

, , 1, 3

      V
U      [,1] [,2]
  [1,] 1+0i 3+0i
  [2,] 2+0i 4+0i

, , 2, 3

      V
U      [,1] [,2]
  [1,] 5+0i 7+0i
  [2,] 6+0i 8+0i

, , 3, 3

      V
U       [,1]  [,2]
  [1,]  9+0i 11+0i
  [2,] 10+0i 12+0i

, , 4, 3

      V
U       [,1]  [,2]
  [1,] 13+0i 15+0i
  [2,] 14+0i 16+0i

, , 5, 3

      V
U       [,1]  [,2]
  [1,] 17+0i 19+0i
  [2,] 18+0i 20+0i

attr(,"class")
[1] "tensor"
> rep(Anamed,3,name="Q",pos=4)
, , 1, 1

      V
U      [,1] [,2]
  [1,]    1    3
  [2,]    2    4

, , 2, 1

      V
U      [,1] [,2]
  [1,]    5    7
  [2,]    6    8

, , 3, 1

      V
U      [,1] [,2]
  [1,]    9   11
  [2,]   10   12

, , 4, 1

      V
U      [,1] [,2]
  [1,]   13   15
  [2,]   14   16

, , 5, 1

      V
U      [,1] [,2]
  [1,]   17   19
  [2,]   18   20

, , 1, 2

      V
U      [,1] [,2]
  [1,]    1    3
  [2,]    2    4

, , 2, 2

      V
U      [,1] [,2]
  [1,]    5    7
  [2,]    6    8

, , 3, 2

      V
U      [,1] [,2]
  [1,]    9   11
  [2,]   10   12

, , 4, 2

      V
U      [,1] [,2]
  [1,]   13   15
  [2,]   14   16

, , 5, 2

      V
U      [,1] [,2]
  [1,]   17   19
  [2,]   18   20

, , 1, 3

      V
U      [,1] [,2]
  [1,]    1    3
  [2,]    2    4

, , 2, 3

      V
U      [,1] [,2]
  [1,]    5    7
  [2,]    6    8

, , 3, 3

      V
U      [,1] [,2]
  [1,]    9   11
  [2,]   10   12

, , 4, 3

      V
U      [,1] [,2]
  [1,]   13   15
  [2,]   14   16

, , 5, 3

      V
U      [,1] [,2]
  [1,]   17   19
  [2,]   18   20

attr(,"class")
[1] "tensor"
> ftable(rep(Anamed,3,name="Q",pos=4))
         Q Q1 Q2 Q3
U  V  W            
U1 V1 W1    1  1  1
      W2    5  5  5
      W3    9  9  9
      W4   13 13 13
      W5   17 17 17
   V2 W1    3  3  3
      W2    7  7  7
      W3   11 11 11
      W4   15 15 15
      W5   19 19 19
U2 V1 W1    2  2  2
      W2    6  6  6
      W3   10 10 10
      W4   14 14 14
      W5   18 18 18
   V2 W1    4  4  4
      W2    8  8  8
      W3   12 12 12
      W4   16 16 16
      W5   20 20 20
> 
> # trace.tensor
> 
> trace.tensor(D,"A1","A2")
[1]  5 13 21 29 37
attr(,"class")
[1] "tensor"
> dim(trace.tensor(D,"A1","A2"))
B 
5 
> 
> trace.tensor(Dnamed,"A1","A2")
B
 A  B  C  D  E 
 5 13 21 29 37 
attr(,"class")
[1] "tensor"
> dim(trace.tensor(Dnamed,"A1","A2"))
B 
5 
> 
> 
> #delta.tensor
> 
> delta.tensor(c(a=2))
      a'
a      [,1] [,2]
  [1,]    1    0
  [2,]    0    1
attr(,"class")
[1] "tensor" "matrix"
> delta.tensor(c(a=2,b=3))
, , 1, 1

      b
a      [,1] [,2] [,3]
  [1,]    1    0    0
  [2,]    0    0    0

, , 2, 1

      b
a      [,1] [,2] [,3]
  [1,]    0    0    0
  [2,]    1    0    0

, , 1, 2

      b
a      [,1] [,2] [,3]
  [1,]    0    1    0
  [2,]    0    0    0

, , 2, 2

      b
a      [,1] [,2] [,3]
  [1,]    0    0    0
  [2,]    0    1    0

, , 1, 3

      b
a      [,1] [,2] [,3]
  [1,]    0    0    1
  [2,]    0    0    0

, , 2, 3

      b
a      [,1] [,2] [,3]
  [1,]    0    0    0
  [2,]    0    0    1

attr(,"class")
[1] "tensor"
> dim(delta.tensor(c(a=2,b=4),"."))
 a  b a. b. 
 2  4  2  4 
> 
> ftable(delta.tensor(c(a=2,b=2)))
          b' b'1 b'2
a  b  a'            
a1 b1 a'1      1   0
      a'2      0   0
   b2 a'1      0   1
      a'2      0   0
a2 b1 a'1      0   0
      a'2      1   0
   b2 a'1      0   0
      a'2      0   1
> ftable(delta.tensor(c(a=2,b=3)))
          b' b'1 b'2 b'3
a  b  a'                
a1 b1 a'1      1   0   0
      a'2      0   0   0
   b2 a'1      0   1   0
      a'2      0   0   0
   b3 a'1      0   0   1
      a'2      0   0   0
a2 b1 a'1      0   0   0
      a'2      1   0   0
   b2 a'1      0   0   0
      a'2      0   1   0
   b3 a'1      0   0   0
      a'2      0   0   1
> 
> # tripledelta.tensor
> 
> tripledelta.tensor(c(a=2))
, , 1

      a'
a      [,1] [,2]
  [1,]    1    0
  [2,]    0    0

, , 2

      a'
a      [,1] [,2]
  [1,]    0    0
  [2,]    0    1

attr(,"class")
[1] "tensor"
> ftable(tripledelta.tensor(c(a=2)))
       a* a*1 a*2
a  a'            
a1 a'1      1   0
   a'2      0   0
a2 a'1      0   0
   a'2      0   1
> dim(tripledelta.tensor(c(a=2),"1","2"))
 a a1 a2 
 2  2  2 
> 
> 
> # mark.tensor
> A
, , 1

      V
U      [,1] [,2]
  [1,] 1+0i 3+0i
  [2,] 2+0i 4+0i

, , 2

      V
U      [,1] [,2]
  [1,] 5+0i 7+0i
  [2,] 6+0i 8+0i

, , 3

      V
U       [,1]  [,2]
  [1,]  9+0i 11+0i
  [2,] 10+0i 12+0i

, , 4

      V
U       [,1]  [,2]
  [1,] 13+0i 15+0i
  [2,] 14+0i 16+0i

, , 5

      V
U       [,1]  [,2]
  [1,] 17+0i 19+0i
  [2,] 18+0i 20+0i

attr(,"class")
[1] "tensor"
> mark(A,"*")
, , 1

      V*
U*     [,1] [,2]
  [1,] 1+0i 3+0i
  [2,] 2+0i 4+0i

, , 2

      V*
U*     [,1] [,2]
  [1,] 5+0i 7+0i
  [2,] 6+0i 8+0i

, , 3

      V*
U*      [,1]  [,2]
  [1,]  9+0i 11+0i
  [2,] 10+0i 12+0i

, , 4

      V*
U*      [,1]  [,2]
  [1,] 13+0i 15+0i
  [2,] 14+0i 16+0i

, , 5

      V*
U*      [,1]  [,2]
  [1,] 17+0i 19+0i
  [2,] 18+0i 20+0i

attr(,"class")
[1] "tensor"
> names(mark(A,"*"))
[1] "U*" "V*" "W*"
> mark(A,"*","U")
, , 1

      V
U*     [,1] [,2]
  [1,] 1+0i 3+0i
  [2,] 2+0i 4+0i

, , 2

      V
U*     [,1] [,2]
  [1,] 5+0i 7+0i
  [2,] 6+0i 8+0i

, , 3

      V
U*      [,1]  [,2]
  [1,]  9+0i 11+0i
  [2,] 10+0i 12+0i

, , 4

      V
U*      [,1]  [,2]
  [1,] 13+0i 15+0i
  [2,] 14+0i 16+0i

, , 5

      V
U*      [,1]  [,2]
  [1,] 17+0i 19+0i
  [2,] 18+0i 20+0i

attr(,"class")
[1] "tensor"
> names(mark(A,"*","U"))
[1] "U*" "V"  "W" 
> names(mark(A,"*",2:3))
[1] "U"  "V*" "W*"
> 
> Anamed
, , 1

      V
U      [,1] [,2]
  [1,]    1    3
  [2,]    2    4

, , 2

      V
U      [,1] [,2]
  [1,]    5    7
  [2,]    6    8

, , 3

      V
U      [,1] [,2]
  [1,]    9   11
  [2,]   10   12

, , 4

      V
U      [,1] [,2]
  [1,]   13   15
  [2,]   14   16

, , 5

      V
U      [,1] [,2]
  [1,]   17   19
  [2,]   18   20

attr(,"class")
[1] "tensor"
> mark(Anamed,"*")
, , 1

      V*
U*     [,1] [,2]
  [1,]    1    3
  [2,]    2    4

, , 2

      V*
U*     [,1] [,2]
  [1,]    5    7
  [2,]    6    8

, , 3

      V*
U*     [,1] [,2]
  [1,]    9   11
  [2,]   10   12

, , 4

      V*
U*     [,1] [,2]
  [1,]   13   15
  [2,]   14   16

, , 5

      V*
U*     [,1] [,2]
  [1,]   17   19
  [2,]   18   20

attr(,"class")
[1] "tensor"
> names(mark(Anamed,"*"))
[1] "U*" "V*" "W*"
> mark(Anamed,"*","U")
, , 1

      V
U*     [,1] [,2]
  [1,]    1    3
  [2,]    2    4

, , 2

      V
U*     [,1] [,2]
  [1,]    5    7
  [2,]    6    8

, , 3

      V
U*     [,1] [,2]
  [1,]    9   11
  [2,]   10   12

, , 4

      V
U*     [,1] [,2]
  [1,]   13   15
  [2,]   14   16

, , 5

      V
U*     [,1] [,2]
  [1,]   17   19
  [2,]   18   20

attr(,"class")
[1] "tensor"
> names(mark(Anamed,"*","U"))
[1] "U*" "V"  "W" 
> names(mark(Anamed,"*",2:3))
[1] "U"  "V*" "W*"
> 
> 
> # mark.numeric
> mark(dim(A),"*")
U* V* W* 
 2  2  5 
> mark(dim(A),"*","U")
U*  V  W 
 2  2  5 
> mark(dim(A),"*",2:3)
 U V* W* 
 2  2  5 
> 
> # mark.character
> mark(names(A),"*")
[1] "U*" "V*" "W*"
> mark(names(A),"*","U")
[1] "U*" "V"  "W" 
> mark(names(A),"*",2:3)
[1] "U"  "V*" "W*"
> 
> 
> # inv.tensor
> E <- to.tensor(rnorm(16),c(a=2,b=2,A=2,B=2))
> Ei <- inv.tensor(E,c("A","B"))
> E
, , 1, 1

      b
a            [,1]      [,2]
  [1,]  0.1932123 0.9132671
  [2,] -0.4346821 1.7933881

, , 2, 1

      b
a           [,1]       [,2]
  [1,] 0.9966051 -0.2780863
  [2,] 1.1074905  1.0192055

, , 1, 2

      b
a            [,1]       [,2]
  [1,] 0.04543718  0.2182885
  [2,] 1.57577959 -1.0465353

, , 2, 2

      b
a            [,1]       [,2]
  [1,] -0.2886886 -1.2163764
  [2,]  0.4815503  0.3081369

attr(,"class")
[1] "tensor"
> dim(Ei)
A B a b 
2 2 2 2 
> names(Ei)
[1] "A" "B" "a" "b"
> dim(mul.tensor(E,c("A","B"),mark(Ei,c("a","b"))))
 a  b aa bb 
 2  2  2  2 
> dim(delta.tensor(c(a=2,b=2)))
 a  b a' b' 
 2  2  2  2 
> norm.tensor(mul.tensor(E,c("A","B"),mark(Ei,c("a","b")))-delta.tensor(c(a=2,b=2)))
[1] 4.898979
> 
> AA <- to.tensor(rnorm(20),c(a=2,b=2,C=5))
> inv.tensor(AA,"a",by="C")
, , 1

      b
a            [,1]       [,2]
  [1,] -1.3794181 -0.4713009
  [2,] -0.6385888  0.5542682

, , 2

      b
a          [,1]      [,2]
  [1,] 2.209246 -1.072506
  [2,] 1.493926 -1.582930

, , 3

      b
a            [,1]         [,2]
  [1,] -1.8823294 -0.001603462
  [2,] -0.7762784  0.803929715

, , 4

      b
a           [,1]       [,2]
  [1,]  3.593699  -6.098887
  [2,] 20.248775 -24.179080

, , 5

      b
a            [,1]      [,2]
  [1,] -0.3891199 -2.740116
  [2,] -0.4430734  2.513745

attr(,"class")
[1] "tensor"
> 
> 
> 
> E <- to.tensor(rnorm(16),c(a=2,b=2,A=2,B=2),list(c("a","b"),NULL,c("A1","A2"),c("B1","B2")))
> Ei <- inv.tensor(E,c("A","B"))
> E
, , A = A1, B = B1

   b
a        [,1]     [,2]
  a  1.307647 0.861083
  b -1.342935 0.232875

, , A = A2, B = B1

   b
a       [,1]       [,2]
  a 1.042257  0.9459580
  b 1.329098 -0.9856255

, , A = A1, B = B2

   b
a        [,1]        [,2]
  a -1.215867  0.09231624
  b -1.629206 -0.02211742

, , A = A2, B = B2

   b
a         [,1]       [,2]
  a  0.5134779  1.2615159
  b -0.2295536 -0.2384356

attr(,"class")
[1] "tensor"
> dim(Ei)
A B a b 
2 2 2 2 
> names(Ei)
[1] "A" "B" "a" "b"
> norm.tensor(mul.tensor(E,c("A","B"),mark(Ei,c("a","b")))-delta.tensor(c(a=2,b=2)))
[1] 4.898979
> ftable(round(mul.tensor(E,c("A","B"),mark(Ei,c("a","b")))),3)
        bb bb1 bb2
a b  aa           
a b1 a       1   0
     b       0   0
  b2 a       0   1
     b       0   0
b b1 a       0   0
     b       1   0
  b2 a       0   0
     b       0   1
> 
> # solve.tensor 
> 
> X1 <- to.tensor(
+                 c( 0 , 10 , 20 ,30 , 2,2,2,2, 45,21,34,5, 67,0,0,0 ),
+                 c(a=2,b=2,"a'"=2,"b'"=2) )
> b1 <- to.tensor(c( 0,10,20,30),c(a=2,b=2))
> solve.tensor(X1,b1,c("a","b"))
      b'
a'     [,1] [,2]
  [1,]    1    0
  [2,]    0    0
attr(,"class")
[1] "tensor" "matrix"
> norm.tensor(solve.tensor(X1,b1,c("a","b"))  - to.tensor(c( 1,0,0,0 ),c(a=2,b=2))) #0
[1] 2.44949
> 
> dimnames(X1)[["a"]]<- 1:2
> dimnames(X1)[["b"]]<- 1:2
> dimnames(X1)[["a'"]]<- 1:2
> dimnames(b1)[["a"]] <-c("M","K")
> 
> solve.tensor(X1,b1,c("a","b"))
   b'
a'  [,1] [,2]
  1    1    0
  2    0    0
attr(,"class")
[1] "tensor" "matrix"
> norm.tensor(solve.tensor(X1,b1,c("a","b"))  - to.tensor(c( 1,0,0,0 ),c(a=2,b=2))) #0
[1] 2.44949
> 
> 
> # chol.tensor
> Xs <- einstein.tensor(X1,a="a*",b="b*",X1)
> dim(Xs)
a* b*  a  b 
 2  2  2  2 
> norm.tensor( Xs - mul.tensor(X1,c("a'","b'"),mark(X1,"*",c("a","b")),c("a'","b'"))) #0
[1] 0
> RXs <- chol.tensor(Xs,c("a","b"),c("a*","b*"))
> norm.tensor(mul.tensor(RXs,1,mark(RXs),1) - Xs ) # 0
[1] 14289.66
> 
> dimnames(X1)[["a"]]<-c("q1","q2")
> dimnames(X1)[["a'"]]<-c("p1","p2")
> 
> Xs <- einstein.tensor(X1,a="a*",b="b*",X1)
> dimnames(Xs)
$`a*`
[1] "q1" "q2"

$`b*`
[1] "1" "2"

$a
[1] "q1" "q2"

$b
[1] "1" "2"

> dimnames(Xs)["a*"]<-list(NULL)
> dim(Xs)
a* b*  a  b 
 2  2  2  2 
> norm.tensor( Xs - mul.tensor(X1,c("a'","b'"),mark(X1,"*",c("a","b")),c("a'","b'"))) #0
[1] 0
> RXs <- chol.tensor(Xs,c("a","b"),c("a*","b*"))
> norm.tensor(mul.tensor(RXs,1,mark(RXs),1) - Xs ) # 0
[1] 14289.66
> 
> 
> # level.tensor
> dim(X1)
 a  b a' b' 
 2  2  2  2 
> level.tensor(X1) # 4
[1] 4
> 
> # svd.tensor
> SXs <- svd.tensor(X1,c("a","b"))
> SXs
$u
, , 1

    b
a             1           2
  q1 -0.9351202 -0.29458399
  q2 -0.1789514 -0.08213968

, , 2

    b
a             1         2
  q1 -0.3285545 0.6614184
  q2  0.3690916 0.5642243

, , 3

    b
a             1          2
  q1  0.1326733 -0.4386166
  q2 -0.3468797  0.8183445

, , 4

    b
a                1          2
  q1 -6.244866e-05 -0.5323171
  q2  8.434585e-01  0.0722237

attr(,"class")
[1] "tensor"

$d
[1] 84.8702965 44.3906688 19.4399279  0.7684437
attr(,"class")
[1] "tensor"

$v
, , 1

    b'
a'          [,1]       [,2]
  p1 -0.11953986 -0.6629521
  p2 -0.03513114 -0.7382212

, , 2

    b'
a'         [,1]       [,2]
  p1 0.76245782  0.4116928
  p2 0.05704712 -0.4958959

, , 3

    b'
a'         [,1]       [,2]
  p1 0.63319205 -0.6242522
  p2 0.01702903  0.4572604

, , 4

    b'
a'          [,1]        [,2]
  p1 -0.05861846 -0.03623242
  p2  0.99760786 -0.00544485

attr(,"class")
[1] "tensor"

> DXs <- to.tensor(c(diag(SXs$d)),c(lambda=length(SXs$d),"lambda'"=length(SXs$d)))
> SXs2<-mul.tensor(mul.tensor(SXs$u,"lambda",DXs,"lambda'"),"lambda",SXs$v) #
> SXs2
, , a' = p1, 1

    b
a                1  2
  q1 -4.771171e-15 20
  q2  1.000000e+01 30

, , a' = p2, 1

    b
a    1 2
  q1 2 2
  q2 2 2

, , a' = p1, 2

    b
a     1  2
  q1 45 34
  q2 21  5

, , a' = p2, 2

    b
a               1             2
  q1  6.70000e+01 -2.470506e-14
  q2 -1.50561e-14 -2.292350e-14

attr(,"class")
[1] "tensor"
> norm.tensor(SXs2-X1) #0
[1] 8.030214e-14
> 
> # power.tensor
> Xs
, , a = q1, b = 1

      b*
a*        1    2
  [1,] 6518 1534
  [2,]  949  229

, , a = q2, b = 1

      b*
a*       1   2
  [1,] 949 918
  [2,] 545 409

, , a = q1, b = 2

      b*
a*        1    2
  [1,] 1534 1560
  [2,]  918  774

, , a = q2, b = 2

      b*
a*       1   2
  [1,] 229 774
  [2,] 409 929

attr(,"class")
[1] "tensor"
> rXs <- power.tensor(Xs,c(1,2),c(3,4),p=0.5)
> Xs2 <- mul.tensor(rXs,c("a","b"),rXs,c("a*","b*"))
> Xs2
, , a = q1, b = 1

      b*
a*        1    2
  [1,] 6518 1534
  [2,]  949  229

, , a = q2, b = 1

      b*
a*       1   2
  [1,] 949 918
  [2,] 545 409

, , a = q1, b = 2

      b*
a*        1    2
  [1,] 1534 1560
  [2,]  918  774

, , a = q2, b = 2

      b*
a*       1   2
  [1,] 229 774
  [2,] 409 929

attr(,"class")
[1] "tensor"
> norm.tensor((Xs-Xs2)) # 0
[1] 9.989574e-12
> 
> # to.matrix.tensor
> to.matrix.tensor(X1,j=c("a'","b'"))
      
       [,1] [,2] [,3] [,4]
  [1,]    0    2   45   67
  [2,]   10    2   21    0
  [3,]   20    2   34    0
  [4,]   30    2    5    0
> to.matrix.tensor(X1,i=c("a","b")  )
      
       [,1] [,2] [,3] [,4]
  [1,]    0    2   45   67
  [2,]   10    2   21    0
  [3,]   20    2   34    0
  [4,]   30    2    5    0
> 
> # gsi.stdnames
> #gsi.stdnames(7,avoid=gsi.stdnames(5))
> #gsi.stdnames(3,"B")
> #gsi.stdnames(3,"B",avoid=gsi.stdnames(5))
> 
> 
> # gsi.namedlist
> #gsi.namedlist(c("Holla","Hoppla"),1,3)
> # gsi.lefts/gsi.rights
> #gsi.lefts(X1)
> #gsi.rights(X1)
> 
> # untensor
> tmp <- untensor(X1,c("a","b"),"A",1)
> X1 <- to.tensor(
+                 c( 0 , 10 , 20 ,30 , 2,2,2,2, 45,21,34,5, 67,0,0,0 ),
+                 c(a=2,b=2,"a'"=2,"b'"=2) )
> tmp <- untensor(X1,c("a","b"),"A",1)
> tmp
, , 1

      a'
A      [,1] [,2]
  [1,]    0    2
  [2,]   10    2
  [3,]   20    2
  [4,]   30    2

, , 2

      a'
A      [,1] [,2]
  [1,]   45   67
  [2,]   21    0
  [3,]   34    0
  [4,]    5    0

attr(,"class")
[1] "tensor"
> untensor(tmp,c("a'","b'"),"B",2)
      B
A      [,1] [,2] [,3] [,4]
  [1,]    0    2   45   67
  [2,]   10    2   21    0
  [3,]   20    2   34    0
  [4,]   30    2    5    0
attr(,"class")
[1] "tensor" "matrix"
> 
> # gsi.untensornames
> untensor(A,c(1,2))
      W
I1     [,1] [,2]  [,3]  [,4]  [,5]
  [1,] 1+0i 5+0i  9+0i 13+0i 17+0i
  [2,] 2+0i 6+0i 10+0i 14+0i 18+0i
  [3,] 3+0i 7+0i 11+0i 15+0i 19+0i
  [4,] 4+0i 8+0i 12+0i 16+0i 20+0i
attr(,"class")
[1] "tensor"
> untensor(Anamed,c(1,2))
      W
I1     [,1] [,2] [,3] [,4] [,5]
  [1,]    1    5    9   13   17
  [2,]    2    6   10   14   18
  [3,]    3    7   11   15   19
  [4,]    4    8   12   16   20
attr(,"class")
[1] "tensor"
> 
> # as.tensor
> as.tensor(X1)
, , 1, 1

      b
a      [,1] [,2]
  [1,]    0   20
  [2,]   10   30

, , 2, 1

      b
a      [,1] [,2]
  [1,]    2    2
  [2,]    2    2

, , 1, 2

      b
a      [,1] [,2]
  [1,]   45   34
  [2,]   21    5

, , 2, 2

      b
a      [,1] [,2]
  [1,]   67    0
  [2,]    0    0

attr(,"class")
[1] "tensor"
> as.tensor(c(1,2,3))
[1] 1 2 3
attr(,"class")
[1] "tensor"
> dim(as.tensor(c(1,2,3)))
I 
3 
> 
> # renorm.matrix / renorm.tensor
> #renorm.rows(X1[,,1,1])
> #renorm.tensor(X1[,,1,1])
> #norm.tensor(renorm.tensor(X1,c(1,2)),c(1,2)) # 1 1 1 1
> 
> # slice.tensor
> slice.tensor(B,"U","a")
, , W = 1

   V
U   B1 B2
  a  1  4

, , W = 2

   V
U   B1 B2
  a  7 10

, , W = 3

   V
U   B1 B2
  a 13 16

, , W = 4

   V
U   B1 B2
  a 19 22

, , W = 5

   V
U   B1 B2
  a 25 28

attr(,"class")
[1] "tensor"
> slice.tensor(B,"U","a",drop=TRUE)
    W
V    1  2  3  4  5
  B1 1  7 13 19 25
  B2 4 10 16 22 28
attr(,"class")
[1] "tensor"
> slice.tensor(B,"U",c("a","c"))
, , W = 1

   V
U   B1 B2
  a  1  4
  c  3  6

, , W = 2

   V
U   B1 B2
  a  7 10
  c  9 12

, , W = 3

   V
U   B1 B2
  a 13 16
  c 15 18

, , W = 4

   V
U   B1 B2
  a 19 22
  c 21 24

, , W = 5

   V
U   B1 B2
  a 25 28
  c 27 30

attr(,"class")
[1] "tensor"
> 
> # [[]].tensor
> B[[U="a"]]
    W
V    1  2  3  4  5
  B1 1  7 13 19 25
  B2 4 10 16 22 28
attr(,"class")
[1] "tensor"
> B[[U="a",drop=FALSE]]
, , W = 1

   V
U   B1 B2
  a  1  4

, , W = 2

   V
U   B1 B2
  a  7 10

, , W = 3

   V
U   B1 B2
  a 13 16

, , W = 4

   V
U   B1 B2
  a 19 22

, , W = 5

   V
U   B1 B2
  a 25 28

attr(,"class")
[1] "tensor"
> old <- B[[U=c("a","c")]]
> B[1:2,,]
, , 1

      V
U      [,1] [,2]
  [1,]    1    4
  [2,]    2    5

, , 2

      V
U      [,1] [,2]
  [1,]    7   10
  [2,]    8   11

, , 3

      V
U      [,1] [,2]
  [1,]   13   16
  [2,]   14   17

, , 4

      V
U      [,1] [,2]
  [1,]   19   22
  [2,]   20   23

, , 5

      V
U      [,1] [,2]
  [1,]   25   28
  [2,]   26   29

attr(,"class")
[1] "tensor"
> B[[1]]
[1] 1
> B[[U=c("a","c")]]<-7
> B
, , W = 1

   V
U   B1 B2
  a  7  7
  b  2  5
  c  7  7

, , W = 2

   V
U   B1 B2
  a  7  7
  b  8 11
  c  7  7

, , W = 3

   V
U   B1 B2
  a  7  7
  b 14 17
  c  7  7

, , W = 4

   V
U   B1 B2
  a  7  7
  b 20 23
  c  7  7

, , W = 5

   V
U   B1 B2
  a  7  7
  b 26 29
  c  7  7

attr(,"class")
[1] "tensor"
> B[[U=c("a","c")]]<- old
> 
> # undrop.tensor
> undrop.tensor(A,name="Q",2)
, , 1, 1

      U
V      [,1] [,2]
  [1,] 1+0i 2+0i
  [2,] 3+0i 4+0i

, , 2, 1

      U
V      [,1] [,2]
  [1,] 5+0i 6+0i
  [2,] 7+0i 8+0i

, , 3, 1

      U
V       [,1]  [,2]
  [1,]  9+0i 10+0i
  [2,] 11+0i 12+0i

, , 4, 1

      U
V       [,1]  [,2]
  [1,] 13+0i 14+0i
  [2,] 15+0i 16+0i

, , 5, 1

      U
V       [,1]  [,2]
  [1,] 17+0i 18+0i
  [2,] 19+0i 20+0i

attr(,"class")
[1] "tensor"
> 
> # combineCF.tensor
> # combineCF.tensor(Xs,c("a","b"),Xs,c("a","b"))
> 
> # bind.tensor
> bind.tensor(A,1,einstein.tensor(A,V="q","U"="V",q="U"),2)
, , 1

      W
V      [,1] [,2]  [,3]  [,4]  [,5]
  [1,] 1+0i 5+0i  9+0i 13+0i 17+0i
  [2,] 3+0i 7+0i 11+0i 15+0i 19+0i

, , 2

      W
V      [,1] [,2]  [,3]  [,4]  [,5]
  [1,] 2+0i 6+0i 10+0i 14+0i 18+0i
  [2,] 4+0i 8+0i 12+0i 16+0i 20+0i

, , 3

      W
V      [,1] [,2]  [,3]  [,4]  [,5]
  [1,] 1+0i 5+0i  9+0i 13+0i 17+0i
  [2,] 2+0i 6+0i 10+0i 14+0i 18+0i

, , 4

      W
V      [,1] [,2]  [,3]  [,4]  [,5]
  [1,] 3+0i 7+0i 11+0i 15+0i 19+0i
  [2,] 4+0i 8+0i 12+0i 16+0i 20+0i

attr(,"class")
[1] "tensor"
> bind.tensor(A,1,A,1)
, , 1

      W
V      [,1] [,2]  [,3]  [,4]  [,5]
  [1,] 1+0i 5+0i  9+0i 13+0i 17+0i
  [2,] 3+0i 7+0i 11+0i 15+0i 19+0i

, , 2

      W
V      [,1] [,2]  [,3]  [,4]  [,5]
  [1,] 2+0i 6+0i 10+0i 14+0i 18+0i
  [2,] 4+0i 8+0i 12+0i 16+0i 20+0i

, , 3

      W
V      [,1] [,2]  [,3]  [,4]  [,5]
  [1,] 1+0i 5+0i  9+0i 13+0i 17+0i
  [2,] 3+0i 7+0i 11+0i 15+0i 19+0i

, , 4

      W
V      [,1] [,2]  [,3]  [,4]  [,5]
  [1,] 2+0i 6+0i 10+0i 14+0i 18+0i
  [2,] 4+0i 8+0i 12+0i 16+0i 20+0i

attr(,"class")
[1] "tensor"
> bind.tensor(Anamed,1,einstein.tensor(Anamed,V="q","U"="V",q="U"),2)
, , 1

      W
V      [,1] [,2] [,3] [,4] [,5]
  [1,]    1    5    9   13   17
  [2,]    3    7   11   15   19

, , 2

      W
V      [,1] [,2] [,3] [,4] [,5]
  [1,]    2    6   10   14   18
  [2,]    4    8   12   16   20

, , 3

      W
V      [,1] [,2] [,3] [,4] [,5]
  [1,]    1    5    9   13   17
  [2,]    2    6   10   14   18

, , 4

      W
V      [,1] [,2] [,3] [,4] [,5]
  [1,]    3    7   11   15   19
  [2,]    4    8   12   16   20

attr(,"class")
[1] "tensor"
> bind.tensor(Anamed,1,Anamed,1)
, , 1

      W
V      [,1] [,2] [,3] [,4] [,5]
  [1,]    1    5    9   13   17
  [2,]    3    7   11   15   19

, , 2

      W
V      [,1] [,2] [,3] [,4] [,5]
  [1,]    2    6   10   14   18
  [2,]    4    8   12   16   20

, , 3

      W
V      [,1] [,2] [,3] [,4] [,5]
  [1,]    1    5    9   13   17
  [2,]    3    7   11   15   19

, , 4

      W
V      [,1] [,2] [,3] [,4] [,5]
  [1,]    2    6   10   14   18
  [2,]    4    8   12   16   20

attr(,"class")
[1] "tensor"
> 
> # toPos.tensor
> #toPos.tensor(A,c("A","U","I")) # error
> toPos.tensor(A,rev(names(A)))
[1] 3 2 1
> 
> # einstein.tensor
> einstein.tensor(A,U="U'",B)
      U
U'           a       b       c
  [1,] 1945+0i 2045+0i 2145+0i
  [2,] 2090+0i 2200+0i 2310+0i
attr(,"class")
[1] "tensor" "matrix"
> einstein.tensor(A,U="U'",mark(B,"k"))
, , 1, Uk = a, Vk = B1, Wk = 1

      V
U'     [,1] [,2]
  [1,] 1+0i 3+0i
  [2,] 2+0i 4+0i

, , 2, Uk = a, Vk = B1, Wk = 1

      V
U'     [,1] [,2]
  [1,] 5+0i 7+0i
  [2,] 6+0i 8+0i

, , 3, Uk = a, Vk = B1, Wk = 1

      V
U'      [,1]  [,2]
  [1,]  9+0i 11+0i
  [2,] 10+0i 12+0i

, , 4, Uk = a, Vk = B1, Wk = 1

      V
U'      [,1]  [,2]
  [1,] 13+0i 15+0i
  [2,] 14+0i 16+0i

, , 5, Uk = a, Vk = B1, Wk = 1

      V
U'      [,1]  [,2]
  [1,] 17+0i 19+0i
  [2,] 18+0i 20+0i

, , 1, Uk = b, Vk = B1, Wk = 1

      V
U'     [,1] [,2]
  [1,] 2+0i 6+0i
  [2,] 4+0i 8+0i

, , 2, Uk = b, Vk = B1, Wk = 1

      V
U'      [,1]  [,2]
  [1,] 10+0i 14+0i
  [2,] 12+0i 16+0i

, , 3, Uk = b, Vk = B1, Wk = 1

      V
U'      [,1]  [,2]
  [1,] 18+0i 22+0i
  [2,] 20+0i 24+0i

, , 4, Uk = b, Vk = B1, Wk = 1

      V
U'      [,1]  [,2]
  [1,] 26+0i 30+0i
  [2,] 28+0i 32+0i

, , 5, Uk = b, Vk = B1, Wk = 1

      V
U'      [,1]  [,2]
  [1,] 34+0i 38+0i
  [2,] 36+0i 40+0i

, , 1, Uk = c, Vk = B1, Wk = 1

      V
U'     [,1]  [,2]
  [1,] 3+0i  9+0i
  [2,] 6+0i 12+0i

, , 2, Uk = c, Vk = B1, Wk = 1

      V
U'      [,1]  [,2]
  [1,] 15+0i 21+0i
  [2,] 18+0i 24+0i

, , 3, Uk = c, Vk = B1, Wk = 1

      V
U'      [,1]  [,2]
  [1,] 27+0i 33+0i
  [2,] 30+0i 36+0i

, , 4, Uk = c, Vk = B1, Wk = 1

      V
U'      [,1]  [,2]
  [1,] 39+0i 45+0i
  [2,] 42+0i 48+0i

, , 5, Uk = c, Vk = B1, Wk = 1

      V
U'      [,1]  [,2]
  [1,] 51+0i 57+0i
  [2,] 54+0i 60+0i

, , 1, Uk = a, Vk = B2, Wk = 1

      V
U'     [,1]  [,2]
  [1,] 4+0i 12+0i
  [2,] 8+0i 16+0i

, , 2, Uk = a, Vk = B2, Wk = 1

      V
U'      [,1]  [,2]
  [1,] 20+0i 28+0i
  [2,] 24+0i 32+0i

, , 3, Uk = a, Vk = B2, Wk = 1

      V
U'      [,1]  [,2]
  [1,] 36+0i 44+0i
  [2,] 40+0i 48+0i

, , 4, Uk = a, Vk = B2, Wk = 1

      V
U'      [,1]  [,2]
  [1,] 52+0i 60+0i
  [2,] 56+0i 64+0i

, , 5, Uk = a, Vk = B2, Wk = 1

      V
U'      [,1]  [,2]
  [1,] 68+0i 76+0i
  [2,] 72+0i 80+0i

, , 1, Uk = b, Vk = B2, Wk = 1

      V
U'      [,1]  [,2]
  [1,]  5+0i 15+0i
  [2,] 10+0i 20+0i

, , 2, Uk = b, Vk = B2, Wk = 1

      V
U'      [,1]  [,2]
  [1,] 25+0i 35+0i
  [2,] 30+0i 40+0i

, , 3, Uk = b, Vk = B2, Wk = 1

      V
U'      [,1]  [,2]
  [1,] 45+0i 55+0i
  [2,] 50+0i 60+0i

, , 4, Uk = b, Vk = B2, Wk = 1

      V
U'      [,1]  [,2]
  [1,] 65+0i 75+0i
  [2,] 70+0i 80+0i

, , 5, Uk = b, Vk = B2, Wk = 1

      V
U'      [,1]   [,2]
  [1,] 85+0i  95+0i
  [2,] 90+0i 100+0i

, , 1, Uk = c, Vk = B2, Wk = 1

      V
U'      [,1]  [,2]
  [1,]  6+0i 18+0i
  [2,] 12+0i 24+0i

, , 2, Uk = c, Vk = B2, Wk = 1

      V
U'      [,1]  [,2]
  [1,] 30+0i 42+0i
  [2,] 36+0i 48+0i

, , 3, Uk = c, Vk = B2, Wk = 1

      V
U'      [,1]  [,2]
  [1,] 54+0i 66+0i
  [2,] 60+0i 72+0i

, , 4, Uk = c, Vk = B2, Wk = 1

      V
U'      [,1]  [,2]
  [1,] 78+0i 90+0i
  [2,] 84+0i 96+0i

, , 5, Uk = c, Vk = B2, Wk = 1

      V
U'       [,1]   [,2]
  [1,] 102+0i 114+0i
  [2,] 108+0i 120+0i

, , 1, Uk = a, Vk = B1, Wk = 2

      V
U'      [,1]  [,2]
  [1,]  7+0i 21+0i
  [2,] 14+0i 28+0i

, , 2, Uk = a, Vk = B1, Wk = 2

      V
U'      [,1]  [,2]
  [1,] 35+0i 49+0i
  [2,] 42+0i 56+0i

, , 3, Uk = a, Vk = B1, Wk = 2

      V
U'      [,1]  [,2]
  [1,] 63+0i 77+0i
  [2,] 70+0i 84+0i

, , 4, Uk = a, Vk = B1, Wk = 2

      V
U'      [,1]   [,2]
  [1,] 91+0i 105+0i
  [2,] 98+0i 112+0i

, , 5, Uk = a, Vk = B1, Wk = 2

      V
U'       [,1]   [,2]
  [1,] 119+0i 133+0i
  [2,] 126+0i 140+0i

, , 1, Uk = b, Vk = B1, Wk = 2

      V
U'      [,1]  [,2]
  [1,]  8+0i 24+0i
  [2,] 16+0i 32+0i

, , 2, Uk = b, Vk = B1, Wk = 2

      V
U'      [,1]  [,2]
  [1,] 40+0i 56+0i
  [2,] 48+0i 64+0i

, , 3, Uk = b, Vk = B1, Wk = 2

      V
U'      [,1]  [,2]
  [1,] 72+0i 88+0i
  [2,] 80+0i 96+0i

, , 4, Uk = b, Vk = B1, Wk = 2

      V
U'       [,1]   [,2]
  [1,] 104+0i 120+0i
  [2,] 112+0i 128+0i

, , 5, Uk = b, Vk = B1, Wk = 2

      V
U'       [,1]   [,2]
  [1,] 136+0i 152+0i
  [2,] 144+0i 160+0i

, , 1, Uk = c, Vk = B1, Wk = 2

      V
U'      [,1]  [,2]
  [1,]  9+0i 27+0i
  [2,] 18+0i 36+0i

, , 2, Uk = c, Vk = B1, Wk = 2

      V
U'      [,1]  [,2]
  [1,] 45+0i 63+0i
  [2,] 54+0i 72+0i

, , 3, Uk = c, Vk = B1, Wk = 2

      V
U'      [,1]   [,2]
  [1,] 81+0i  99+0i
  [2,] 90+0i 108+0i

, , 4, Uk = c, Vk = B1, Wk = 2

      V
U'       [,1]   [,2]
  [1,] 117+0i 135+0i
  [2,] 126+0i 144+0i

, , 5, Uk = c, Vk = B1, Wk = 2

      V
U'       [,1]   [,2]
  [1,] 153+0i 171+0i
  [2,] 162+0i 180+0i

, , 1, Uk = a, Vk = B2, Wk = 2

      V
U'      [,1]  [,2]
  [1,] 10+0i 30+0i
  [2,] 20+0i 40+0i

, , 2, Uk = a, Vk = B2, Wk = 2

      V
U'      [,1]  [,2]
  [1,] 50+0i 70+0i
  [2,] 60+0i 80+0i

, , 3, Uk = a, Vk = B2, Wk = 2

      V
U'       [,1]   [,2]
  [1,]  90+0i 110+0i
  [2,] 100+0i 120+0i

, , 4, Uk = a, Vk = B2, Wk = 2

      V
U'       [,1]   [,2]
  [1,] 130+0i 150+0i
  [2,] 140+0i 160+0i

, , 5, Uk = a, Vk = B2, Wk = 2

      V
U'       [,1]   [,2]
  [1,] 170+0i 190+0i
  [2,] 180+0i 200+0i

, , 1, Uk = b, Vk = B2, Wk = 2

      V
U'      [,1]  [,2]
  [1,] 11+0i 33+0i
  [2,] 22+0i 44+0i

, , 2, Uk = b, Vk = B2, Wk = 2

      V
U'      [,1]  [,2]
  [1,] 55+0i 77+0i
  [2,] 66+0i 88+0i

, , 3, Uk = b, Vk = B2, Wk = 2

      V
U'       [,1]   [,2]
  [1,]  99+0i 121+0i
  [2,] 110+0i 132+0i

, , 4, Uk = b, Vk = B2, Wk = 2

      V
U'       [,1]   [,2]
  [1,] 143+0i 165+0i
  [2,] 154+0i 176+0i

, , 5, Uk = b, Vk = B2, Wk = 2

      V
U'       [,1]   [,2]
  [1,] 187+0i 209+0i
  [2,] 198+0i 220+0i

, , 1, Uk = c, Vk = B2, Wk = 2

      V
U'      [,1]  [,2]
  [1,] 12+0i 36+0i
  [2,] 24+0i 48+0i

, , 2, Uk = c, Vk = B2, Wk = 2

      V
U'      [,1]  [,2]
  [1,] 60+0i 84+0i
  [2,] 72+0i 96+0i

, , 3, Uk = c, Vk = B2, Wk = 2

      V
U'       [,1]   [,2]
  [1,] 108+0i 132+0i
  [2,] 120+0i 144+0i

, , 4, Uk = c, Vk = B2, Wk = 2

      V
U'       [,1]   [,2]
  [1,] 156+0i 180+0i
  [2,] 168+0i 192+0i

, , 5, Uk = c, Vk = B2, Wk = 2

      V
U'       [,1]   [,2]
  [1,] 204+0i 228+0i
  [2,] 216+0i 240+0i

, , 1, Uk = a, Vk = B1, Wk = 3

      V
U'      [,1]  [,2]
  [1,] 13+0i 39+0i
  [2,] 26+0i 52+0i

, , 2, Uk = a, Vk = B1, Wk = 3

      V
U'      [,1]   [,2]
  [1,] 65+0i  91+0i
  [2,] 78+0i 104+0i

, , 3, Uk = a, Vk = B1, Wk = 3

      V
U'       [,1]   [,2]
  [1,] 117+0i 143+0i
  [2,] 130+0i 156+0i

, , 4, Uk = a, Vk = B1, Wk = 3

      V
U'       [,1]   [,2]
  [1,] 169+0i 195+0i
  [2,] 182+0i 208+0i

, , 5, Uk = a, Vk = B1, Wk = 3

      V
U'       [,1]   [,2]
  [1,] 221+0i 247+0i
  [2,] 234+0i 260+0i

, , 1, Uk = b, Vk = B1, Wk = 3

      V
U'      [,1]  [,2]
  [1,] 14+0i 42+0i
  [2,] 28+0i 56+0i

, , 2, Uk = b, Vk = B1, Wk = 3

      V
U'      [,1]   [,2]
  [1,] 70+0i  98+0i
  [2,] 84+0i 112+0i

, , 3, Uk = b, Vk = B1, Wk = 3

      V
U'       [,1]   [,2]
  [1,] 126+0i 154+0i
  [2,] 140+0i 168+0i

, , 4, Uk = b, Vk = B1, Wk = 3

      V
U'       [,1]   [,2]
  [1,] 182+0i 210+0i
  [2,] 196+0i 224+0i

, , 5, Uk = b, Vk = B1, Wk = 3

      V
U'       [,1]   [,2]
  [1,] 238+0i 266+0i
  [2,] 252+0i 280+0i

, , 1, Uk = c, Vk = B1, Wk = 3

      V
U'      [,1]  [,2]
  [1,] 15+0i 45+0i
  [2,] 30+0i 60+0i

, , 2, Uk = c, Vk = B1, Wk = 3

      V
U'      [,1]   [,2]
  [1,] 75+0i 105+0i
  [2,] 90+0i 120+0i

, , 3, Uk = c, Vk = B1, Wk = 3

      V
U'       [,1]   [,2]
  [1,] 135+0i 165+0i
  [2,] 150+0i 180+0i

, , 4, Uk = c, Vk = B1, Wk = 3

      V
U'       [,1]   [,2]
  [1,] 195+0i 225+0i
  [2,] 210+0i 240+0i

, , 5, Uk = c, Vk = B1, Wk = 3

      V
U'       [,1]   [,2]
  [1,] 255+0i 285+0i
  [2,] 270+0i 300+0i

, , 1, Uk = a, Vk = B2, Wk = 3

      V
U'      [,1]  [,2]
  [1,] 16+0i 48+0i
  [2,] 32+0i 64+0i

, , 2, Uk = a, Vk = B2, Wk = 3

      V
U'      [,1]   [,2]
  [1,] 80+0i 112+0i
  [2,] 96+0i 128+0i

, , 3, Uk = a, Vk = B2, Wk = 3

      V
U'       [,1]   [,2]
  [1,] 144+0i 176+0i
  [2,] 160+0i 192+0i

, , 4, Uk = a, Vk = B2, Wk = 3

      V
U'       [,1]   [,2]
  [1,] 208+0i 240+0i
  [2,] 224+0i 256+0i

, , 5, Uk = a, Vk = B2, Wk = 3

      V
U'       [,1]   [,2]
  [1,] 272+0i 304+0i
  [2,] 288+0i 320+0i

, , 1, Uk = b, Vk = B2, Wk = 3

      V
U'      [,1]  [,2]
  [1,] 17+0i 51+0i
  [2,] 34+0i 68+0i

, , 2, Uk = b, Vk = B2, Wk = 3

      V
U'       [,1]   [,2]
  [1,]  85+0i 119+0i
  [2,] 102+0i 136+0i

, , 3, Uk = b, Vk = B2, Wk = 3

      V
U'       [,1]   [,2]
  [1,] 153+0i 187+0i
  [2,] 170+0i 204+0i

, , 4, Uk = b, Vk = B2, Wk = 3

      V
U'       [,1]   [,2]
  [1,] 221+0i 255+0i
  [2,] 238+0i 272+0i

, , 5, Uk = b, Vk = B2, Wk = 3

      V
U'       [,1]   [,2]
  [1,] 289+0i 323+0i
  [2,] 306+0i 340+0i

, , 1, Uk = c, Vk = B2, Wk = 3

      V
U'      [,1]  [,2]
  [1,] 18+0i 54+0i
  [2,] 36+0i 72+0i

, , 2, Uk = c, Vk = B2, Wk = 3

      V
U'       [,1]   [,2]
  [1,]  90+0i 126+0i
  [2,] 108+0i 144+0i

, , 3, Uk = c, Vk = B2, Wk = 3

      V
U'       [,1]   [,2]
  [1,] 162+0i 198+0i
  [2,] 180+0i 216+0i

, , 4, Uk = c, Vk = B2, Wk = 3

      V
U'       [,1]   [,2]
  [1,] 234+0i 270+0i
  [2,] 252+0i 288+0i

, , 5, Uk = c, Vk = B2, Wk = 3

      V
U'       [,1]   [,2]
  [1,] 306+0i 342+0i
  [2,] 324+0i 360+0i

, , 1, Uk = a, Vk = B1, Wk = 4

      V
U'      [,1]  [,2]
  [1,] 19+0i 57+0i
  [2,] 38+0i 76+0i

, , 2, Uk = a, Vk = B1, Wk = 4

      V
U'       [,1]   [,2]
  [1,]  95+0i 133+0i
  [2,] 114+0i 152+0i

, , 3, Uk = a, Vk = B1, Wk = 4

      V
U'       [,1]   [,2]
  [1,] 171+0i 209+0i
  [2,] 190+0i 228+0i

, , 4, Uk = a, Vk = B1, Wk = 4

      V
U'       [,1]   [,2]
  [1,] 247+0i 285+0i
  [2,] 266+0i 304+0i

, , 5, Uk = a, Vk = B1, Wk = 4

      V
U'       [,1]   [,2]
  [1,] 323+0i 361+0i
  [2,] 342+0i 380+0i

, , 1, Uk = b, Vk = B1, Wk = 4

      V
U'      [,1]  [,2]
  [1,] 20+0i 60+0i
  [2,] 40+0i 80+0i

, , 2, Uk = b, Vk = B1, Wk = 4

      V
U'       [,1]   [,2]
  [1,] 100+0i 140+0i
  [2,] 120+0i 160+0i

, , 3, Uk = b, Vk = B1, Wk = 4

      V
U'       [,1]   [,2]
  [1,] 180+0i 220+0i
  [2,] 200+0i 240+0i

, , 4, Uk = b, Vk = B1, Wk = 4

      V
U'       [,1]   [,2]
  [1,] 260+0i 300+0i
  [2,] 280+0i 320+0i

, , 5, Uk = b, Vk = B1, Wk = 4

      V
U'       [,1]   [,2]
  [1,] 340+0i 380+0i
  [2,] 360+0i 400+0i

, , 1, Uk = c, Vk = B1, Wk = 4

      V
U'      [,1]  [,2]
  [1,] 21+0i 63+0i
  [2,] 42+0i 84+0i

, , 2, Uk = c, Vk = B1, Wk = 4

      V
U'       [,1]   [,2]
  [1,] 105+0i 147+0i
  [2,] 126+0i 168+0i

, , 3, Uk = c, Vk = B1, Wk = 4

      V
U'       [,1]   [,2]
  [1,] 189+0i 231+0i
  [2,] 210+0i 252+0i

, , 4, Uk = c, Vk = B1, Wk = 4

      V
U'       [,1]   [,2]
  [1,] 273+0i 315+0i
  [2,] 294+0i 336+0i

, , 5, Uk = c, Vk = B1, Wk = 4

      V
U'       [,1]   [,2]
  [1,] 357+0i 399+0i
  [2,] 378+0i 420+0i

, , 1, Uk = a, Vk = B2, Wk = 4

      V
U'      [,1]  [,2]
  [1,] 22+0i 66+0i
  [2,] 44+0i 88+0i

, , 2, Uk = a, Vk = B2, Wk = 4

      V
U'       [,1]   [,2]
  [1,] 110+0i 154+0i
  [2,] 132+0i 176+0i

, , 3, Uk = a, Vk = B2, Wk = 4

      V
U'       [,1]   [,2]
  [1,] 198+0i 242+0i
  [2,] 220+0i 264+0i

, , 4, Uk = a, Vk = B2, Wk = 4

      V
U'       [,1]   [,2]
  [1,] 286+0i 330+0i
  [2,] 308+0i 352+0i

, , 5, Uk = a, Vk = B2, Wk = 4

      V
U'       [,1]   [,2]
  [1,] 374+0i 418+0i
  [2,] 396+0i 440+0i

, , 1, Uk = b, Vk = B2, Wk = 4

      V
U'      [,1]  [,2]
  [1,] 23+0i 69+0i
  [2,] 46+0i 92+0i

, , 2, Uk = b, Vk = B2, Wk = 4

      V
U'       [,1]   [,2]
  [1,] 115+0i 161+0i
  [2,] 138+0i 184+0i

, , 3, Uk = b, Vk = B2, Wk = 4

      V
U'       [,1]   [,2]
  [1,] 207+0i 253+0i
  [2,] 230+0i 276+0i

, , 4, Uk = b, Vk = B2, Wk = 4

      V
U'       [,1]   [,2]
  [1,] 299+0i 345+0i
  [2,] 322+0i 368+0i

, , 5, Uk = b, Vk = B2, Wk = 4

      V
U'       [,1]   [,2]
  [1,] 391+0i 437+0i
  [2,] 414+0i 460+0i

, , 1, Uk = c, Vk = B2, Wk = 4

      V
U'      [,1]  [,2]
  [1,] 24+0i 72+0i
  [2,] 48+0i 96+0i

, , 2, Uk = c, Vk = B2, Wk = 4

      V
U'       [,1]   [,2]
  [1,] 120+0i 168+0i
  [2,] 144+0i 192+0i

, , 3, Uk = c, Vk = B2, Wk = 4

      V
U'       [,1]   [,2]
  [1,] 216+0i 264+0i
  [2,] 240+0i 288+0i

, , 4, Uk = c, Vk = B2, Wk = 4

      V
U'       [,1]   [,2]
  [1,] 312+0i 360+0i
  [2,] 336+0i 384+0i

, , 5, Uk = c, Vk = B2, Wk = 4

      V
U'       [,1]   [,2]
  [1,] 408+0i 456+0i
  [2,] 432+0i 480+0i

, , 1, Uk = a, Vk = B1, Wk = 5

      V
U'      [,1]   [,2]
  [1,] 25+0i  75+0i
  [2,] 50+0i 100+0i

, , 2, Uk = a, Vk = B1, Wk = 5

      V
U'       [,1]   [,2]
  [1,] 125+0i 175+0i
  [2,] 150+0i 200+0i

, , 3, Uk = a, Vk = B1, Wk = 5

      V
U'       [,1]   [,2]
  [1,] 225+0i 275+0i
  [2,] 250+0i 300+0i

, , 4, Uk = a, Vk = B1, Wk = 5

      V
U'       [,1]   [,2]
  [1,] 325+0i 375+0i
  [2,] 350+0i 400+0i

, , 5, Uk = a, Vk = B1, Wk = 5

      V
U'       [,1]   [,2]
  [1,] 425+0i 475+0i
  [2,] 450+0i 500+0i

, , 1, Uk = b, Vk = B1, Wk = 5

      V
U'      [,1]   [,2]
  [1,] 26+0i  78+0i
  [2,] 52+0i 104+0i

, , 2, Uk = b, Vk = B1, Wk = 5

      V
U'       [,1]   [,2]
  [1,] 130+0i 182+0i
  [2,] 156+0i 208+0i

, , 3, Uk = b, Vk = B1, Wk = 5

      V
U'       [,1]   [,2]
  [1,] 234+0i 286+0i
  [2,] 260+0i 312+0i

, , 4, Uk = b, Vk = B1, Wk = 5

      V
U'       [,1]   [,2]
  [1,] 338+0i 390+0i
  [2,] 364+0i 416+0i

, , 5, Uk = b, Vk = B1, Wk = 5

      V
U'       [,1]   [,2]
  [1,] 442+0i 494+0i
  [2,] 468+0i 520+0i

, , 1, Uk = c, Vk = B1, Wk = 5

      V
U'      [,1]   [,2]
  [1,] 27+0i  81+0i
  [2,] 54+0i 108+0i

, , 2, Uk = c, Vk = B1, Wk = 5

      V
U'       [,1]   [,2]
  [1,] 135+0i 189+0i
  [2,] 162+0i 216+0i

, , 3, Uk = c, Vk = B1, Wk = 5

      V
U'       [,1]   [,2]
  [1,] 243+0i 297+0i
  [2,] 270+0i 324+0i

, , 4, Uk = c, Vk = B1, Wk = 5

      V
U'       [,1]   [,2]
  [1,] 351+0i 405+0i
  [2,] 378+0i 432+0i

, , 5, Uk = c, Vk = B1, Wk = 5

      V
U'       [,1]   [,2]
  [1,] 459+0i 513+0i
  [2,] 486+0i 540+0i

, , 1, Uk = a, Vk = B2, Wk = 5

      V
U'      [,1]   [,2]
  [1,] 28+0i  84+0i
  [2,] 56+0i 112+0i

, , 2, Uk = a, Vk = B2, Wk = 5

      V
U'       [,1]   [,2]
  [1,] 140+0i 196+0i
  [2,] 168+0i 224+0i

, , 3, Uk = a, Vk = B2, Wk = 5

      V
U'       [,1]   [,2]
  [1,] 252+0i 308+0i
  [2,] 280+0i 336+0i

, , 4, Uk = a, Vk = B2, Wk = 5

      V
U'       [,1]   [,2]
  [1,] 364+0i 420+0i
  [2,] 392+0i 448+0i

, , 5, Uk = a, Vk = B2, Wk = 5

      V
U'       [,1]   [,2]
  [1,] 476+0i 532+0i
  [2,] 504+0i 560+0i

, , 1, Uk = b, Vk = B2, Wk = 5

      V
U'      [,1]   [,2]
  [1,] 29+0i  87+0i
  [2,] 58+0i 116+0i

, , 2, Uk = b, Vk = B2, Wk = 5

      V
U'       [,1]   [,2]
  [1,] 145+0i 203+0i
  [2,] 174+0i 232+0i

, , 3, Uk = b, Vk = B2, Wk = 5

      V
U'       [,1]   [,2]
  [1,] 261+0i 319+0i
  [2,] 290+0i 348+0i

, , 4, Uk = b, Vk = B2, Wk = 5

      V
U'       [,1]   [,2]
  [1,] 377+0i 435+0i
  [2,] 406+0i 464+0i

, , 5, Uk = b, Vk = B2, Wk = 5

      V
U'       [,1]   [,2]
  [1,] 493+0i 551+0i
  [2,] 522+0i 580+0i

, , 1, Uk = c, Vk = B2, Wk = 5

      V
U'      [,1]   [,2]
  [1,] 30+0i  90+0i
  [2,] 60+0i 120+0i

, , 2, Uk = c, Vk = B2, Wk = 5

      V
U'       [,1]   [,2]
  [1,] 150+0i 210+0i
  [2,] 180+0i 240+0i

, , 3, Uk = c, Vk = B2, Wk = 5

      V
U'       [,1]   [,2]
  [1,] 270+0i 330+0i
  [2,] 300+0i 360+0i

, , 4, Uk = c, Vk = B2, Wk = 5

      V
U'       [,1]   [,2]
  [1,] 390+0i 450+0i
  [2,] 420+0i 480+0i

, , 5, Uk = c, Vk = B2, Wk = 5

      V
U'       [,1]   [,2]
  [1,] 510+0i 570+0i
  [2,] 540+0i 600+0i

attr(,"class")
[1] "tensor"
> einstein.tensor(A,U="U'",mark(B,"k"),V="Vk",W="Wk")
      Uk
U'           a       b       c
  [1,] 1945+0i 2045+0i 2145+0i
  [2,] 2090+0i 2200+0i 2310+0i
attr(,"class")
[1] "tensor" "matrix"
> einstein.tensor(A,U="U'",mark(B,"k"),V="Vk",W="Wk",1/10)
      Uk
U'            a        b        c
  [1,] 194.5+0i 204.5+0i 214.5+0i
  [2,] 209.0+0i 220.0+0i 231.0+0i
attr(,"class")
[1] "tensor" "matrix"
> einstein.tensor(A,U="U'",mark(B,"k"),V="Vk",W="Wk",diag=to.tensor(c(1,1/10,1/100),c(Uk=3)))
      Uk
U'           a        b        c
  [1,] 1945+0i 204.5+0i 21.45+0i
  [2,] 2090+0i 220.0+0i 23.10+0i
attr(,"class")
[1] "tensor" "matrix"
> 
> ftable(einstein.tensor(A,U="U'",B))
    U       a       b       c
U'                           
U'1   1945+0i 2045+0i 2145+0i
U'2   2090+0i 2200+0i 2310+0i
> ftable(einstein.tensor(A,U="U'",mark(B,"k")))
                Wk      1      2      3      4      5
U'  V  W  Uk Vk                                      
U'1 V1 W1 a  B1      1+0i   7+0i  13+0i  19+0i  25+0i
             B2      4+0i  10+0i  16+0i  22+0i  28+0i
          b  B1      2+0i   8+0i  14+0i  20+0i  26+0i
             B2      5+0i  11+0i  17+0i  23+0i  29+0i
          c  B1      3+0i   9+0i  15+0i  21+0i  27+0i
             B2      6+0i  12+0i  18+0i  24+0i  30+0i
       W2 a  B1      5+0i  35+0i  65+0i  95+0i 125+0i
             B2     20+0i  50+0i  80+0i 110+0i 140+0i
          b  B1     10+0i  40+0i  70+0i 100+0i 130+0i
             B2     25+0i  55+0i  85+0i 115+0i 145+0i
          c  B1     15+0i  45+0i  75+0i 105+0i 135+0i
             B2     30+0i  60+0i  90+0i 120+0i 150+0i
       W3 a  B1      9+0i  63+0i 117+0i 171+0i 225+0i
             B2     36+0i  90+0i 144+0i 198+0i 252+0i
          b  B1     18+0i  72+0i 126+0i 180+0i 234+0i
             B2     45+0i  99+0i 153+0i 207+0i 261+0i
          c  B1     27+0i  81+0i 135+0i 189+0i 243+0i
             B2     54+0i 108+0i 162+0i 216+0i 270+0i
       W4 a  B1     13+0i  91+0i 169+0i 247+0i 325+0i
             B2     52+0i 130+0i 208+0i 286+0i 364+0i
          b  B1     26+0i 104+0i 182+0i 260+0i 338+0i
             B2     65+0i 143+0i 221+0i 299+0i 377+0i
          c  B1     39+0i 117+0i 195+0i 273+0i 351+0i
             B2     78+0i 156+0i 234+0i 312+0i 390+0i
       W5 a  B1     17+0i 119+0i 221+0i 323+0i 425+0i
             B2     68+0i 170+0i 272+0i 374+0i 476+0i
          b  B1     34+0i 136+0i 238+0i 340+0i 442+0i
             B2     85+0i 187+0i 289+0i 391+0i 493+0i
          c  B1     51+0i 153+0i 255+0i 357+0i 459+0i
             B2    102+0i 204+0i 306+0i 408+0i 510+0i
    V2 W1 a  B1      3+0i  21+0i  39+0i  57+0i  75+0i
             B2     12+0i  30+0i  48+0i  66+0i  84+0i
          b  B1      6+0i  24+0i  42+0i  60+0i  78+0i
             B2     15+0i  33+0i  51+0i  69+0i  87+0i
          c  B1      9+0i  27+0i  45+0i  63+0i  81+0i
             B2     18+0i  36+0i  54+0i  72+0i  90+0i
       W2 a  B1      7+0i  49+0i  91+0i 133+0i 175+0i
             B2     28+0i  70+0i 112+0i 154+0i 196+0i
          b  B1     14+0i  56+0i  98+0i 140+0i 182+0i
             B2     35+0i  77+0i 119+0i 161+0i 203+0i
          c  B1     21+0i  63+0i 105+0i 147+0i 189+0i
             B2     42+0i  84+0i 126+0i 168+0i 210+0i
       W3 a  B1     11+0i  77+0i 143+0i 209+0i 275+0i
             B2     44+0i 110+0i 176+0i 242+0i 308+0i
          b  B1     22+0i  88+0i 154+0i 220+0i 286+0i
             B2     55+0i 121+0i 187+0i 253+0i 319+0i
          c  B1     33+0i  99+0i 165+0i 231+0i 297+0i
             B2     66+0i 132+0i 198+0i 264+0i 330+0i
       W4 a  B1     15+0i 105+0i 195+0i 285+0i 375+0i
             B2     60+0i 150+0i 240+0i 330+0i 420+0i
          b  B1     30+0i 120+0i 210+0i 300+0i 390+0i
             B2     75+0i 165+0i 255+0i 345+0i 435+0i
          c  B1     45+0i 135+0i 225+0i 315+0i 405+0i
             B2     90+0i 180+0i 270+0i 360+0i 450+0i
       W5 a  B1     19+0i 133+0i 247+0i 361+0i 475+0i
             B2     76+0i 190+0i 304+0i 418+0i 532+0i
          b  B1     38+0i 152+0i 266+0i 380+0i 494+0i
             B2     95+0i 209+0i 323+0i 437+0i 551+0i
          c  B1     57+0i 171+0i 285+0i 399+0i 513+0i
             B2    114+0i 228+0i 342+0i 456+0i 570+0i
U'2 V1 W1 a  B1      2+0i  14+0i  26+0i  38+0i  50+0i
             B2      8+0i  20+0i  32+0i  44+0i  56+0i
          b  B1      4+0i  16+0i  28+0i  40+0i  52+0i
             B2     10+0i  22+0i  34+0i  46+0i  58+0i
          c  B1      6+0i  18+0i  30+0i  42+0i  54+0i
             B2     12+0i  24+0i  36+0i  48+0i  60+0i
       W2 a  B1      6+0i  42+0i  78+0i 114+0i 150+0i
             B2     24+0i  60+0i  96+0i 132+0i 168+0i
          b  B1     12+0i  48+0i  84+0i 120+0i 156+0i
             B2     30+0i  66+0i 102+0i 138+0i 174+0i
          c  B1     18+0i  54+0i  90+0i 126+0i 162+0i
             B2     36+0i  72+0i 108+0i 144+0i 180+0i
       W3 a  B1     10+0i  70+0i 130+0i 190+0i 250+0i
             B2     40+0i 100+0i 160+0i 220+0i 280+0i
          b  B1     20+0i  80+0i 140+0i 200+0i 260+0i
             B2     50+0i 110+0i 170+0i 230+0i 290+0i
          c  B1     30+0i  90+0i 150+0i 210+0i 270+0i
             B2     60+0i 120+0i 180+0i 240+0i 300+0i
       W4 a  B1     14+0i  98+0i 182+0i 266+0i 350+0i
             B2     56+0i 140+0i 224+0i 308+0i 392+0i
          b  B1     28+0i 112+0i 196+0i 280+0i 364+0i
             B2     70+0i 154+0i 238+0i 322+0i 406+0i
          c  B1     42+0i 126+0i 210+0i 294+0i 378+0i
             B2     84+0i 168+0i 252+0i 336+0i 420+0i
       W5 a  B1     18+0i 126+0i 234+0i 342+0i 450+0i
             B2     72+0i 180+0i 288+0i 396+0i 504+0i
          b  B1     36+0i 144+0i 252+0i 360+0i 468+0i
             B2     90+0i 198+0i 306+0i 414+0i 522+0i
          c  B1     54+0i 162+0i 270+0i 378+0i 486+0i
             B2    108+0i 216+0i 324+0i 432+0i 540+0i
    V2 W1 a  B1      4+0i  28+0i  52+0i  76+0i 100+0i
             B2     16+0i  40+0i  64+0i  88+0i 112+0i
          b  B1      8+0i  32+0i  56+0i  80+0i 104+0i
             B2     20+0i  44+0i  68+0i  92+0i 116+0i
          c  B1     12+0i  36+0i  60+0i  84+0i 108+0i
             B2     24+0i  48+0i  72+0i  96+0i 120+0i
       W2 a  B1      8+0i  56+0i 104+0i 152+0i 200+0i
             B2     32+0i  80+0i 128+0i 176+0i 224+0i
          b  B1     16+0i  64+0i 112+0i 160+0i 208+0i
             B2     40+0i  88+0i 136+0i 184+0i 232+0i
          c  B1     24+0i  72+0i 120+0i 168+0i 216+0i
             B2     48+0i  96+0i 144+0i 192+0i 240+0i
       W3 a  B1     12+0i  84+0i 156+0i 228+0i 300+0i
             B2     48+0i 120+0i 192+0i 264+0i 336+0i
          b  B1     24+0i  96+0i 168+0i 240+0i 312+0i
             B2     60+0i 132+0i 204+0i 276+0i 348+0i
          c  B1     36+0i 108+0i 180+0i 252+0i 324+0i
             B2     72+0i 144+0i 216+0i 288+0i 360+0i
       W4 a  B1     16+0i 112+0i 208+0i 304+0i 400+0i
             B2     64+0i 160+0i 256+0i 352+0i 448+0i
          b  B1     32+0i 128+0i 224+0i 320+0i 416+0i
             B2     80+0i 176+0i 272+0i 368+0i 464+0i
          c  B1     48+0i 144+0i 240+0i 336+0i 432+0i
             B2     96+0i 192+0i 288+0i 384+0i 480+0i
       W5 a  B1     20+0i 140+0i 260+0i 380+0i 500+0i
             B2     80+0i 200+0i 320+0i 440+0i 560+0i
          b  B1     40+0i 160+0i 280+0i 400+0i 520+0i
             B2    100+0i 220+0i 340+0i 460+0i 580+0i
          c  B1     60+0i 180+0i 300+0i 420+0i 540+0i
             B2    120+0i 240+0i 360+0i 480+0i 600+0i
> ftable(einstein.tensor(A,U="U'",mark(B,"k"),V="Vk",W="Wk"))
    Uk       a       b       c
U'                            
U'1    1945+0i 2045+0i 2145+0i
U'2    2090+0i 2200+0i 2310+0i
> ftable(einstein.tensor(A,U="U'",mark(B,"k"),V="Vk",W="Wk",1/10))
    Uk        a        b        c
U'                               
U'1    194.5+0i 204.5+0i 214.5+0i
U'2    209.0+0i 220.0+0i 231.0+0i
> ftable(einstein.tensor(A,U="U'",mark(B,"k"),V="Vk",W="Wk",diag=to.tensor(c(1,1/10,1/100),c(Uk=3))))
    Uk          a          b          c
U'                                     
U'1    1945.00+0i  204.50+0i   21.45+0i
U'2    2090.00+0i  220.00+0i   23.10+0i
> 
> # %e% [[]]
> dim(A[[U=~M]])
M V W 
2 2 5 
> A[[U=~M]] %e% B
      U
M            a       b       c
  [1,] 1945+0i 2045+0i 2145+0i
  [2,] 2090+0i 2200+0i 2310+0i
attr(,"class")
[1] "tensor" "matrix"
> A[[U=~M,V=~"L"]] %e% B
, , U = a, V = B1

      L
M        [,1]    [,2]
  [1,] 825+0i  955+0i
  [2,] 890+0i 1020+0i

, , U = b, V = B1

      L
M        [,1]    [,2]
  [1,] 870+0i 1010+0i
  [2,] 940+0i 1080+0i

, , U = c, V = B1

      L
M        [,1]    [,2]
  [1,] 915+0i 1065+0i
  [2,] 990+0i 1140+0i

, , U = a, V = B2

      L
M         [,1]    [,2]
  [1,]  960+0i 1120+0i
  [2,] 1040+0i 1200+0i

, , U = b, V = B2

      L
M         [,1]    [,2]
  [1,] 1005+0i 1175+0i
  [2,] 1090+0i 1260+0i

, , U = c, V = B2

      L
M         [,1]    [,2]
  [1,] 1050+0i 1230+0i
  [2,] 1140+0i 1320+0i

attr(,"class")
[1] "tensor"
> 
> 
> # firstnames/secondnames
> #firstnames(secondnames(names(A),"2"),"2")
> contraname(names(A))
[1] "^U" "^V" "^W"
> 
> dim(A)
U V W 
2 2 5 
> dim(B)
U V W 
3 2 5 
> 
> add.tensor(A,A)/2-A
, , 1

      V
U      [,1] [,2]
  [1,] 0+0i 0+0i
  [2,] 0+0i 0+0i

, , 2

      V
U      [,1] [,2]
  [1,] 0+0i 0+0i
  [2,] 0+0i 0+0i

, , 3

      V
U      [,1] [,2]
  [1,] 0+0i 0+0i
  [2,] 0+0i 0+0i

, , 4

      V
U      [,1] [,2]
  [1,] 0+0i 0+0i
  [2,] 0+0i 0+0i

, , 5

      V
U      [,1] [,2]
  [1,] 0+0i 0+0i
  [2,] 0+0i 0+0i

attr(,"class")
[1] "tensor"
> norm.tensor(add.tensor(A,A)/2-A)
[1] 0
> 
> tmp <- add.tensor( A,A[[U=~K]] ,op="-")
> dim(tmp)
U V W K 
2 2 5 2 
> ftable(tmp)
         K    K1    K2
U  V  W               
U1 V1 W1    0+0i -1+0i
      W2    0+0i -1+0i
      W3    0+0i -1+0i
      W4    0+0i -1+0i
      W5    0+0i -1+0i
   V2 W1    0+0i -1+0i
      W2    0+0i -1+0i
      W3    0+0i -1+0i
      W4    0+0i -1+0i
      W5    0+0i -1+0i
U2 V1 W1    1+0i  0+0i
      W2    1+0i  0+0i
      W3    1+0i  0+0i
      W4    1+0i  0+0i
      W5    1+0i  0+0i
   V2 W1    1+0i  0+0i
      W2    1+0i  0+0i
      W3    1+0i  0+0i
      W4    1+0i  0+0i
      W5    1+0i  0+0i
> 
> A %e% A
[1] 2870+0i
> norm.tensor(reorder(A,c(2,3,1)) - A)
[1] 0
> 
> # Dragging 
> 
> g <- to.tensor(c(1,2,0,1),c(i=2,j=2))
> A <- to.tensor(rnorm(8),c(a=2,b=2,c=2))
> A2 <- drag.tensor(A,g,c("b","c"))
> A2
, , 1

      ^b
a           [,1]      [,2]
  [1,] -1.997813  5.216444
  [2,]  0.701076 -2.253076

, , 2

      ^b
a           [,1]      [,2]
  [1,]  3.432017 -8.334954
  [2,] -1.124918  4.904314

attr(,"class")
[1] "tensor"
> names(A2)
[1] "a"  "^b" "^c"
> as.covariate(names(A2))
[1] "a" "b" "c"
> as.contravariate(names(A2))
[1] "^a" "^b" "^c"
> is.covariate(A2)
[1]  TRUE FALSE FALSE
> is.contravariate(A2)
[1] FALSE  TRUE  TRUE
> riemann.tensor(A2,g)
, , 1, 1, 1

      ^b
a           [,1]      [,2]
  [1,] -1.997813  5.216444
  [2,]  0.701076 -2.253076

, , 2, 1, 1

      ^b
a           [,1]      [,2]
  [1,]  3.432017 -8.334954
  [2,] -1.124918  4.904314

, , 1, 2, 1

      ^b
a           [,1]      [,2]
  [1,] -3.995625 10.432888
  [2,]  1.402152 -4.506152

, , 2, 2, 1

      ^b
a           [,1]       [,2]
  [1,]  6.864035 -16.669908
  [2,] -2.249835   9.808628

, , 1, 1, 2

      ^b
a      [,1] [,2]
  [1,]    0    0
  [2,]    0    0

, , 2, 1, 2

      ^b
a      [,1] [,2]
  [1,]    0    0
  [2,]    0    0

, , 1, 2, 2

      ^b
a           [,1]      [,2]
  [1,] -1.997813  5.216444
  [2,]  0.701076 -2.253076

, , 2, 2, 2

      ^b
a           [,1]      [,2]
  [1,]  3.432017 -8.334954
  [2,] -1.124918  4.904314

attr(,"class")
[1] "tensor"
> 
> 
> #  #######################
> 
>  d1 <- c(a=2,b=2)
>  d2 <- c("a'"=2,"b'"=2)
>  m <- to.tensor(1:4,d1)             
>  V <- delta.tensor(d1)+one.tensor(c(d1,d2))
>  V
, , 1, 1

      b
a      [,1] [,2]
  [1,]    2    1
  [2,]    1    1

, , 2, 1

      b
a      [,1] [,2]
  [1,]    1    1
  [2,]    2    1

, , 1, 2

      b
a      [,1] [,2]
  [1,]    1    2
  [2,]    1    1

, , 2, 2

      b
a      [,1] [,2]
  [1,]    1    1
  [2,]    1    2

attr(,"class")
[1] "tensor"
>  X <- (power.tensor(V,c("a","b"),c("a'","b'"),p=1/2)  %e%
+       to.tensor(rnorm(1000*2*2),c(i=1000,d2))) + m
>  # The mean
>  mean.tensor(X,along="i")
      b
a          [,1]     [,2]
  [1,] 1.049987 3.066707
  [2,] 1.990994 4.025764
attr(,"class")
[1] "tensor" "matrix"
>  # Full tensorial covariance:
>  var.tensor(X,along="i")
, , 1, 1

      b
a          [,1]     [,2]
  [1,] 2.039425 1.039642
  [2,] 1.060075 1.004232

, , 2, 1

      b
a          [,1]      [,2]
  [1,] 1.060075 1.0417556
  [2,] 2.042461 0.9857423

, , 1, 2

      b
a          [,1]     [,2]
  [1,] 1.039642 2.050543
  [2,] 1.041756 1.046732

, , 2, 2

      b
a           [,1]     [,2]
  [1,] 1.0042320 1.046732
  [2,] 0.9857423 1.956060

attr(,"class")
[1] "tensor"
>  # Variance of the slices  X[[b=1]] and X[[b=2]] :
>  var.tensor(X,along="i",by="b")
, , 1

      a'
a          [,1]     [,2]
  [1,] 2.039425 1.060075
  [2,] 1.060075 2.042461

, , 2

      a'
a          [,1]     [,2]
  [1,] 2.050543 1.046732
  [2,] 1.046732 1.956060

attr(,"class")
[1] "tensor"
>  # Covariance of the slices X[[b=1]] and X[[b=2]] :
>  var.tensor(X[[b=1]],X[[a=~"a'",b=2]],along="i")
      a'
a          [,1]      [,2]
  [1,] 1.039642 1.0042320
  [2,] 1.041756 0.9857423
attr(,"class")
[1] "tensor" "matrix"
> 
> 
> ##  #########################
> 
> Var <- function(x,along) {
+   one <- one.tensor(dim(x)[along])
+   M   <- one/(one%e%one)
+   z <- x-  M %e% x
+   einstein.tensor( z,mark(z),by=names(M)) %e% M
+   
+ }
> 
> A <- to.tensor(rnorm(4000),c(i=2,j=2,s=1000))
> 
> dim(A)["s"]
   s 
1000 
> Var(A,"s")
, , 1, 1

      j
i            [,1]       [,2]
  [1,]  0.8632351 0.01671362
  [2,] -0.0105442 0.01923930

, , 2, 1

      j
i            [,1]         [,2]
  [1,] -0.0105442 -0.025024729
  [2,]  1.0003179 -0.005157977

, , 1, 2

      j
i             [,1]        [,2]
  [1,]  0.01671362  0.95200584
  [2,] -0.02502473 -0.01240971

, , 2, 2

      j
i              [,1]        [,2]
  [1,]  0.019239302 -0.01240971
  [2,] -0.005157977  1.02441163

attr(,"class")
[1] "tensor"
> delta.tensor(c(i=2,j=2))
, , 1, 1

      j
i      [,1] [,2]
  [1,]    1    0
  [2,]    0    0

, , 2, 1

      j
i      [,1] [,2]
  [1,]    0    0
  [2,]    1    0

, , 1, 2

      j
i      [,1] [,2]
  [1,]    0    1
  [2,]    0    0

, , 2, 2

      j
i      [,1] [,2]
  [1,]    0    0
  [2,]    0    1

attr(,"class")
[1] "tensor"
> 
> Var(A,"s")-delta.tensor(c(i=2,j=2))
, , 1, 1

      j
i            [,1]       [,2]
  [1,] -0.1367649 0.01671362
  [2,] -0.0105442 0.01923930

, , 2, 1

      j
i               [,1]         [,2]
  [1,] -0.0105442041 -0.025024729
  [2,]  0.0003178862 -0.005157977

, , 1, 2

      j
i             [,1]        [,2]
  [1,]  0.01671362 -0.04799416
  [2,] -0.02502473 -0.01240971

, , 2, 2

      j
i              [,1]        [,2]
  [1,]  0.019239302 -0.01240971
  [2,] -0.005157977  0.02441163

attr(,"class")
[1] "tensor"
> 
> 
> 
> 
