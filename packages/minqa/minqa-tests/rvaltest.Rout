
R version 4.4.0 (2024-04-24) -- "Puppy Cup"
Copyright (C) 2024 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(minqa)
> 
> ## maxfn <- function(x) 10 - crossprod(x - seq_along(x))^2
> minfn <- function(x) crossprod(x - seq_along(x))^2 - 10
> 
> x0 <- rep.int(pi, 4)
> reschk <- function(res) {
+ #    stopifnot(is.list(res),
+ #              inherits(res, "minqa"),
+ #              names(res) == c("par", "fval", "feval", "ierr", "msg"),
+ #              is.numeric(res$par),
+ #              all.equal(res$par, 1:4, tol = 2e-4),
+ #              is.numeric(res$fval),
+ #              all.equal(as.vector(res$fval), -10, check.attributes = FALSE, tol = 1e-4),
+ #              is.integer(res$feval),
+ #              res$feval > 0)
+      test<-c(is.list(res),
+              inherits(res, "minqa"),
+              isTRUE(all(names(res) == c("par", "fval", "feval", "ierr", "msg"))),
+              is.numeric(res$par),
+              isTRUE(all.equal(res$par, 1:4, tol = 2e-4)),
+              is.numeric(res$fval),
+              isTRUE(all.equal(as.vector(res$fval), -10, check.attributes = FALSE, tol = 1e-4)),
+              is.integer(res$feval),
+              res$feval > 0)
+     names(test)<-c("is.list", "inheritsOK", "namesOK", "is.numeric-par",
+                    "paramsOK","is.numeric-fn","fnOK","is.integer-fval",
+                    "feval>0")
+     idx<-which(! test)
+     msg<-paste("reschk failed",names(test)[idx],sep=', ')
+     if ( ! all(test)) warning(msg)
+ }
> # NOTE: we do not check ierr or msg here. JN 20100810
> sessionInfo()
R version 4.4.0 (2024-04-24)
Platform: x86_64-pc-linux-gnu
Running under: Ubuntu 22.04.4 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

time zone: Europe/London
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] minqa_1.2.7

loaded via a namespace (and not attached):
[1] compiler_4.4.0 Rcpp_1.0.12   
> reschk(ans.nd <- newuoa(x0, minfn, control = list(iprint = 2)))
npt = 6 , n =  4 
rhobeg =  0.6283185 , rhoend =  6.283185e-07 
start par. =  3.141593 3.141593 3.141593 3.141593 fn =  34.17682 
rho:    0.063 eval:  11 fn:     -4.01972 par: 2.46553  2.48381  2.77080  3.89476 
rho:   0.0063 eval:  52 fn:     -9.87159 par: 1.41393  2.33022  3.22579  4.16424 
rho:  0.00063 eval: 129 fn:     -9.99966 par:0.957330  2.08106  3.05276  4.08473 
rho:  6.3e-05 eval: 329 fn:     -9.99996 par:0.945739  2.04889  3.02734  4.00071 
rho:  6.3e-06 eval: 518 fn:     -10.0000 par:0.997566  1.99573  2.99651  3.99961 
rho:  6.3e-07 eval: 572 fn:     -10.0000 par:0.999939  1.99929  2.99744  4.00178 
At return
eval: 809 fn:     -10.000000 par:  1.00034  1.99955  2.99972  4.00033
> ans.nd
parameter estimates: 1.00034063661515, 1.99954821646134, 2.99972221235818, 4.00032787209295 
objective: -9.99999999999975 
number of function evaluations: 809 
> reschk(ans.ud <- uobyqa(x0, minfn, control = list(iprint = 2)))
npt = 6 , n =  4 
rhobeg =  0.6283185 , rhoend =  6.283185e-07 
start par. =  3.141593 3.141593 3.141593 3.141593 fn =  34.17682 
rho:    0.063 eval:  38 fn:     -9.99248 par:-1.25915 0.890636  2.28247  4.84038 
rho:   0.0063 eval:  73 fn:     -10.0000 par: 1.06352  1.98876  3.28135  3.98821 
rho:  0.00063 eval:  91 fn:     -10.0000 par:0.991424  1.99623  3.00680  4.00414 
rho:  6.3e-05 eval: 130 fn:     -10.0000 par: 1.00344  2.00075  2.99844  4.00288 
rho:  6.3e-06 eval: 148 fn:     -10.0000 par: 1.00014  1.99993  3.00013  3.99990 
rho:  6.3e-07 eval: 166 fn:     -10.0000 par: 1.00016  1.99998  3.00011  3.99989 
At return
eval: 184 fn:     -10.000000 par:  1.00016  1.99998  3.00011  3.99989
> ans.ud
parameter estimates: 1.0001557430063, 1.99998494138262, 3.00011308568884, 3.99988625597738 
objective: -10 
number of function evaluations: 184 
> reschk(ans.bd <- bobyqa(x0, minfn, control = list(iprint = 2)))
npt = 6 , n =  4 
rhobeg =  0.6283185 , rhoend =  6.283185e-07 
start par. =  3.141593 3.141593 3.141593 3.141593 fn =  34.17682 
rho:    0.063 eval:   9 fn:     -3.97899 par: 2.46646  2.48616  2.76457  3.89280 
rho:   0.0063 eval:  29 fn:     -8.92984 par: 1.87729  2.38076  2.76474  3.74600 
rho:  0.00063 eval: 105 fn:     -9.98701 par: 1.19666  2.18089  3.17408  3.88915 
rho:  6.3e-05 eval: 257 fn:     -9.99865 par: 1.00577  2.16347  3.08469  3.94751 
rho:  6.3e-06 eval: 470 fn:     -10.0000 par:0.996767  2.01205  3.02131  4.02255 
rho:  6.3e-07 eval: 714 fn:     -10.0000 par:0.999088  2.00279  3.00496  4.00565 
At return
eval: 914 fn:     -10.000000 par:  1.00048  2.00004  2.99994  4.00020
> ans.bd
parameter estimates: 1.00048286464791, 2.00004057599767, 2.99994493857353, 4.00019652125042 
objective: -9.99999999999992 
number of function evaluations: 914 
> 
> 
